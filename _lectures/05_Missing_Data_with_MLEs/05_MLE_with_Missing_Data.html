<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jonathan Templin">
<meta name="dcterms.date" content="2025-03-05">

<title>Maximum Likelihood Estimation with Missing Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="05_MLE_with_Missing_Data_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_MLE_with_Missing_Data_files/libs/quarto-html/quarto.js"></script>
<script src="05_MLE_with_Missing_Data_files/libs/quarto-html/popper.min.js"></script>
<script src="05_MLE_with_Missing_Data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05_MLE_with_Missing_Data_files/libs/quarto-html/anchor.min.js"></script>
<link href="05_MLE_with_Missing_Data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_MLE_with_Missing_Data_files/libs/quarto-html/quarto-syntax-highlighting-f23ab18612d661d7bd56dbc0c0fd3817.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05_MLE_with_Missing_Data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05_MLE_with_Missing_Data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05_MLE_with_Missing_Data_files/libs/bootstrap/bootstrap-e19dc0c07aeef78048e587c3f1edba7a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Maximum Likelihood Estimation with Missing Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jonathan Templin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This document demonstrates Maximum Likelihood Estimation (MLE) in the presence of missing data, following Chapter 3 of Enders (2022). The examples utilize the <code>lavaan</code> package for structural equation modeling (SEM) and demonstrate the handling of missing data using FIML (Full Information Maximum Likelihood).</p>
</section>
<section id="loading-required-packages" class="level1">
<h1>Loading Required Packages</h1>
<p>We begin by loading necessary packages. If they are not installed, the script will install them first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(mvtnorm)) <span class="fu">install.packages</span>(<span class="st">"mvtnorm"</span>); <span class="fu">library</span>(mvtnorm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(lavaan)) <span class="fu">install.packages</span>(<span class="st">"lavaan"</span>); <span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lavaan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(semPlot)) <span class="fu">install.packages</span>(<span class="st">"semPlot"</span>); <span class="fu">library</span>(semPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: semPlot</code></pre>
</div>
</div>
<section id="simulating-data-for-the-example" class="level2">
<h2 class="anchored" data-anchor-id="simulating-data-for-the-example">Simulating Data for the Example</h2>
<p>In this section, we generate simulated data for the analysis. The data consist of two groups: men and women, with predefined means, correlations, and standard deviations for a set of variables. We then combine these datasets and prepare them for further analysis.</p>
<section id="setting-the-seed" class="level3">
<h3 class="anchored" data-anchor-id="setting-the-seed">Setting the Seed</h3>
<p>Setting a seed ensures reproducibility so that the same random numbers are generated each time the script is run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250223</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="defining-sample-sizes" class="level3">
<h3 class="anchored" data-anchor-id="defining-sample-sizes">Defining Sample Sizes</h3>
<p>We define the sample sizes for the two groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Nmen <span class="ot">=</span> <span class="dv">121</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Nwomen <span class="ot">=</span> <span class="dv">229</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="defining-mean-vectors" class="level3">
<h3 class="anchored" data-anchor-id="defining-mean-vectors">Defining Mean Vectors</h3>
<p>The mean vectors for men and women are specified for the seven variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MeanMEN <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">5.081333347</span>, <span class="fl">9.723030258</span>, <span class="fl">51.94404048</span>, <span class="fl">52.66452548</span>, <span class="fl">34.04606078</span>, <span class="fl">77.06181845</span>, <span class="fl">14.75389904</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>MeanWOMEN <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">4.80418631</span>, <span class="fl">10.60486174</span>, <span class="fl">50.34834542</span>, <span class="fl">48.13359134</span>, <span class="fl">30.61321679</span>, <span class="fl">71.77082955</span>, <span class="fl">13.75449003</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These vectors contain the expected means for each variable in the dataset.</p>
</section>
<section id="defining-the-correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-correlation-matrix">Defining the Correlation Matrix</h3>
<p>We specify the correlations among the seven variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Corr <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.0</span>,  .<span class="dv">15</span>, .<span class="dv">12</span>, .<span class="dv">48</span>, .<span class="dv">44</span>, .<span class="dv">47</span>, .<span class="dv">44</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">15</span>, <span class="fl">1.0</span>, .<span class="dv">06</span>, .<span class="dv">25</span>, .<span class="dv">20</span>, .<span class="dv">23</span>, .<span class="dv">23</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">12</span>, .<span class="dv">06</span>, <span class="fl">1.0</span>, .<span class="dv">40</span>, .<span class="dv">32</span>, .<span class="dv">19</span>, .<span class="dv">14</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">48</span>, .<span class="dv">25</span>, .<span class="dv">40</span>, <span class="fl">1.0</span>, .<span class="dv">87</span>, .<span class="dv">61</span>, .<span class="dv">54</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">44</span>, .<span class="dv">20</span>, .<span class="dv">32</span>, .<span class="dv">87</span>, <span class="fl">1.0</span>, .<span class="dv">56</span>, .<span class="dv">51</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">47</span>, .<span class="dv">23</span>, .<span class="dv">19</span>, .<span class="dv">61</span>, .<span class="dv">56</span>, <span class="fl">1.0</span>, .<span class="dv">70</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  .<span class="dv">44</span>, .<span class="dv">23</span>, .<span class="dv">14</span>, .<span class="dv">54</span>, .<span class="dv">51</span>, .<span class="dv">70</span>, <span class="fl">1.0</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="defining-standard-deviations-and-constructing-the-covariance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="defining-standard-deviations-and-constructing-the-covariance-matrix">Defining Standard Deviations and Constructing the Covariance Matrix</h3>
<p>The standard deviations are stored in a vector and used to compute the covariance matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>SD <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">6.0</span>, <span class="fl">15.2</span>, <span class="fl">16.6</span>, <span class="fl">10.9</span>, <span class="fl">10.5</span>, <span class="fl">2.8</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>SDdiag <span class="ot">=</span> <span class="fu">diag</span>(SD)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the covariance matrix</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Cov <span class="ot">=</span> SDdiag <span class="sc">%*%</span> Corr <span class="sc">%*%</span> SDdiag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generating-multivariate-normal-data" class="level3">
<h3 class="anchored" data-anchor-id="generating-multivariate-normal-data">Generating Multivariate Normal Data</h3>
<p>Using the <code>rmvnorm</code> function, we generate normally distributed data for both groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>xmen <span class="ot">=</span> <span class="fu">rmvnorm</span>(Nmen, MeanMEN, Cov)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>xwomen <span class="ot">=</span> <span class="fu">rmvnorm</span>(Nwomen, MeanWOMEN, Cov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adding-group-identifiers" class="level3">
<h3 class="anchored" data-anchor-id="adding-group-identifiers">Adding Group Identifiers</h3>
<p>To distinguish between men and women, we append a group identifier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>xmen <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">0</span>, xmen)  <span class="co"># 1 for men</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>xwomen <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, xwomen)  <span class="co"># 0 for women</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-and-formatting-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="combining-and-formatting-the-dataset">Combining and Formatting the Dataset</h3>
<p>The two datasets are combined into a single data frame, and column names are assigned:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>allx <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(xmen, xwomen))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allx) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"hsl"</span>, <span class="st">"cc"</span>, <span class="st">"use"</span>, <span class="st">"msc"</span>, <span class="st">"mas"</span>, <span class="st">"mse"</span>, <span class="st">"perf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At this point, we have a dataset with 350 observations (121 men and 229 women), each with values on seven variables. The variable <code>female</code> acts as a binary indicator (0 = male, 1 = female).</p>
</section>
</section>
<section id="introducing-missingness-in-key-variables" class="level2">
<h2 class="anchored" data-anchor-id="introducing-missingness-in-key-variables">Introducing Missingness in Key Variables</h2>
<p>This section introduces missing data into three variables (<code>cc</code>, <code>perf</code>, and <code>use</code>) based on other variables in the dataset. The probability of missingness is modeled using logistic regression equations that depend on <code>female</code>, <code>msc</code>, <code>mas</code>, and <code>mse</code>.</p>
<section id="introducing-missingness-in-cc" class="level3">
<h3 class="anchored" data-anchor-id="introducing-missingness-in-cc">Introducing Missingness in <code>cc</code></h3>
<p>We first define a logistic regression model for missingness in <code>cc</code>, using coefficients that determine how each predictor influences the probability of missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>M_CC_intercept <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>M_CC_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>M_CC_msc <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>M_CC_mas <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>M_CC_mse <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>missingCCmodelLogit <span class="ot">=</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  M_CC_intercept <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  M_CC_female<span class="sc">*</span>allx[,<span class="st">"female"</span>] <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  M_CC_msc<span class="sc">*</span>allx[,<span class="st">"msc"</span>] <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  M_CC_mas<span class="sc">*</span>allx[,<span class="st">"mas"</span>] <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  M_CC_mse<span class="sc">*</span>allx[,<span class="st">"mse"</span>]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>missingCCmodelProb <span class="ot">=</span> <span class="fu">exp</span>(missingCCmodelLogit)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(missingCCmodelLogit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using these probabilities, we introduce missing values in <code>cc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>makeMissingCC <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">runif</span>(Nmen<span class="sc">+</span>Nwomen) <span class="sc">&lt;</span> missingCCmodelProb)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>cc[makeMissingCC] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>cc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 20.68877296  1.65602752 13.73681033 16.69345233 14.66009497          NA
  [7] 14.58032616 13.96476009          NA          NA -0.83703882 21.18673647
 [13]          NA 26.68356242 14.61730439  9.60319763 17.60507955  2.41473267
 [19] 12.19443765 10.68450120 11.30622665 -1.35699819 11.91915130          NA
 [25] -0.70991074          NA  7.22494813 13.52459626          NA  6.80542846
 [31] -9.00976198          NA 10.82767888  5.63044279 22.51437445 12.83848468
 [37]  4.31661597          NA 16.23420693          NA  2.29597163  2.54519198
 [43]  6.11027746          NA 10.13889582          NA  7.72287315 12.39414602
 [49]          NA  7.45660786 -1.65879328          NA  8.17387658  5.80435467
 [55] 12.22399190  7.63844283          NA 14.18856745  2.96468040          NA
 [61]  4.17224558  9.58928727  4.17705061  7.21909165  7.20645800 15.78044896
 [67]          NA          NA 28.14369310 -3.95927529 18.44520928 18.70995946
 [73] 13.74913339  4.68597920  7.99430875 10.37992360          NA          NA
 [79]          NA  2.71711412 12.93064679          NA  8.63599807          NA
 [85] 14.32572241 13.47978601 18.43434851 14.90355313  3.66127219          NA
 [91]  2.82502647 14.83554489  9.98063535  8.24816285  6.08310985          NA
 [97]          NA  1.39457305  5.62523811 11.75549884  3.93349207 20.45183338
[103] 24.25621031 10.84340723 -2.84450014 13.05872326  9.04898555  2.53536260
[109]  8.64944912 -0.01670160 10.71754742 10.36362085  1.80423382  7.53049158
[115] 15.03613391          NA  4.83098135  7.69556621 -1.08588238          NA
[121] 20.19254523 13.22546293          NA          NA          NA  4.97476537
[127]  5.15342649  2.61963061          NA  7.31788397          NA 15.51772754
[133]  2.54117098          NA 17.52726534 21.71285310  8.84326442          NA
[139] 25.82702399 11.90511587          NA -3.02333067 12.46731186          NA
[145] 13.34106674  2.02597485 14.53714471          NA  9.33414912 -0.84084674
[151]          NA 23.63180122 13.19510328  3.48271022 21.38718621  9.49092808
[157]  3.07328202 21.56445345  1.26162964 -4.94984000          NA          NA
[163]  3.03042720 12.09593584 19.29345513          NA  7.27376992          NA
[169]  5.83638107 14.02980526  9.97739131          NA 13.30099567 14.14158735
[175]          NA  3.17356989          NA  6.02834603 11.30359147 -0.08038210
[181]          NA          NA 11.75849005 11.76825913 10.67281282  7.45948021
[187]  5.40098562 24.51226796 15.11396647  3.69062700 17.22218008 12.21719678
[193]  3.26261970          NA 15.81342167 26.30823576 18.21626595  3.83694005
[199]          NA          NA          NA -2.96432020          NA 15.70318920
[205]  4.21512995          NA 16.67881390 11.74920261 11.81829496 10.91841027
[211] 13.58045227          NA 14.13052072          NA  3.57643827          NA
[217] 18.84649533  8.00503778  7.26123490 16.27713426  7.90041344          NA
[223]          NA 21.47220079 11.62737839  4.16300013          NA  4.43626219
[229]          NA          NA          NA 12.83767154  4.77358290  4.60727157
[235]  6.78529494 16.17905186  5.47012243 10.71751969          NA  9.88217712
[241]  5.19128754          NA 20.12108506 16.74394103 11.74419815          NA
[247]          NA  6.77343122          NA  4.19443908          NA          NA
[253]          NA  4.95320079  1.28836215 12.35997231 15.69213505 13.12414624
[259]  6.05560820 -1.04684220  2.52473359 17.33472307          NA          NA
[265]  3.34179491          NA          NA  3.35071208 14.17605790 16.54374229
[271]          NA  4.89561025          NA 10.02568251          NA  5.64409116
[277]  4.16025019 11.95087151 11.61832686          NA          NA 13.58890687
[283]  9.37765839  8.58732735 14.58023686 -1.03078572  7.35680729          NA
[289]          NA 22.91332725  2.29257932  4.04884083          NA  2.22596863
[295] 14.09941692          NA  6.81444476          NA 14.13808192          NA
[301] 11.92672483 10.95158820  6.59646306          NA 12.60915360 13.38213625
[307]          NA  4.57794368  7.63830798  9.80753680          NA  6.79913995
[313] 14.20393139  2.77927947          NA          NA 17.03332922  0.05252297
[319]          NA 11.43643877 13.19939049          NA 14.49636806          NA
[325]          NA          NA          NA 10.90855017  6.06223292  5.37893438
[331] 12.12554920  6.86094626          NA          NA  6.69547733          NA
[337]          NA  6.69898494          NA          NA          NA -4.94986051
[343] 10.25306957          NA 15.51230101 17.86009476  2.72476148 12.32847625
[349] 14.49991310  3.67101654</code></pre>
</div>
</div>
</section>
<section id="introducing-missingness-in-perf" class="level3">
<h3 class="anchored" data-anchor-id="introducing-missingness-in-perf">Introducing Missingness in <code>perf</code></h3>
<p>Next, we define a logistic model for missingness in <code>perf</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>M_perf_intercept <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>M_perf_female <span class="ot">=</span> .<span class="dv">5</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>M_perf_msc <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>M_perf_mas <span class="ot">=</span> .<span class="dv">02</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>M_perf_mse <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>missingPERFmodelLogit <span class="ot">=</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  M_perf_intercept <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  M_perf_female<span class="sc">*</span>allx[,<span class="st">"female"</span>] <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  M_perf_msc<span class="sc">*</span>allx[,<span class="st">"msc"</span>] <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  M_perf_mas<span class="sc">*</span>allx[,<span class="st">"mas"</span>] <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  M_perf_mse<span class="sc">*</span>allx[,<span class="st">"mse"</span>]</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>missingPERFmodelProb <span class="ot">=</span> <span class="fu">exp</span>(missingPERFmodelLogit)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(missingPERFmodelLogit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then apply this model to introduce missing values in <code>perf</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>makeMissingPerf <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">runif</span>(Nmen<span class="sc">+</span>Nwomen) <span class="sc">&lt;</span> missingPERFmodelProb)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>perf[makeMissingPerf] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>perf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 11.776558 20.532909        NA 12.014992        NA 15.273834        NA
  [8] 13.903625 17.686551        NA 13.284943 13.757807 17.605380 17.324344
 [15] 13.413876 17.298330 13.005129 17.396852 14.690130 16.918552        NA
 [22] 18.221247 15.433579 11.323378 16.682367 14.087046 14.028023 18.004349
 [29]        NA 16.864636  5.860316 13.793872        NA 13.611799        NA
 [36] 18.231649 15.850543 15.598164 14.521375 13.505225 14.861601 10.177396
 [43]  9.842593 15.922507 14.214737 18.223424 16.622598 14.881453 12.707240
 [50] 11.150810        NA 19.506276 14.662785 13.761915        NA 13.669431
 [57]        NA 16.006301 15.177665 14.089205        NA 13.496658 11.571074
 [64] 15.938117  9.607525 13.643152  8.961143 13.948205 14.282404 13.523190
 [71] 15.268891 11.201664 18.009158 12.677790 12.430438 16.673858        NA
 [78]        NA 14.445838 14.317263 15.647369 18.784013 12.242757 15.474515
 [85]        NA 13.104960 14.187725 15.377330 13.985991        NA 11.988029
 [92] 13.584972 12.582491        NA 19.975444 13.277893 17.974763 14.165004
 [99] 18.884884 15.960231 12.222217  9.544307 18.087247 16.232268 13.009203
[106] 20.680876 13.612148 12.005250 18.583906 14.768090        NA 14.539714
[113] 12.164501 12.539997        NA 18.912096 12.058256        NA 16.756301
[120] 13.215008 16.670072        NA 12.035312  8.173500        NA 14.686185
[127]  7.700439 11.923834        NA 13.403689        NA 15.293682 11.679634
[134]        NA 15.935398 14.185794 12.636334        NA 14.557324        NA
[141]        NA        NA        NA 10.457553 15.338546  8.624914  9.955488
[148] 16.992809 11.534040 13.853268 15.345128 14.993545        NA 10.702232
[155]        NA 11.251722        NA 14.760888 15.828686 12.465003 15.285171
[162] 18.726137 11.666261        NA 12.036275 15.671001 14.410638 13.231104
[169] 12.169025 12.926418  9.326221 13.238511 13.200097  7.254682        NA
[176]        NA 17.942116 14.779456 14.966809 12.469036        NA  9.130764
[183] 11.250993 12.101902  8.763037 15.089698  9.307276 14.986260        NA
[190]  7.933676 12.651794 13.923861  9.560389 16.752783        NA        NA
[197] 13.199872 15.446361 11.081655        NA        NA 15.735516 10.914531
[204] 16.065137        NA 15.413576 15.431361  6.269605 14.785674        NA
[211]        NA 12.622339        NA 21.155096        NA 14.589418 19.456695
[218] 10.739210 14.796098        NA 12.425648 15.782967 15.110793        NA
[225]        NA 13.369133        NA 12.749807 18.770868        NA 17.661898
[232] 14.806020 12.644463        NA  6.476010        NA 13.944203  8.450241
[239]        NA        NA 11.787318 16.772767 15.571792        NA        NA
[246]        NA 14.217849 11.686289 15.520662 11.394952 14.205548        NA
[253] 17.593349        NA        NA 15.207729        NA 14.042116        NA
[260] 11.609236  9.950430 16.016002 15.438955        NA 12.433468  8.438971
[267]  9.323093 12.448831 12.512473 14.412143 11.607975        NA 16.007915
[274]        NA 13.290832 13.392632 17.388186 17.991244 11.973358 17.417919
[281] 14.793300 12.462660 12.432486 16.661573        NA  9.163985 12.155169
[288] 11.459977 13.470446 16.256209 14.476314        NA 11.375561 18.146211
[295] 15.558148 11.508424 12.433611 18.202976        NA 10.277156 10.529435
[302] 16.978648        NA        NA 13.244885 14.128402 14.199863 10.310462
[309]  9.744907  9.623580        NA 16.472275 15.258739 11.380671 13.898693
[316] 13.991704  8.604307 13.622807 13.507030        NA 11.534204        NA
[323] 11.988585  9.177616        NA        NA 14.537967  8.383236 12.000601
[330]  9.112816 14.905749 12.184384 15.740261 13.987004 18.343706 18.811134
[337] 11.598980 16.541879 15.719937 17.388073 14.645793        NA        NA
[344] 17.109487 15.758917        NA  9.350367 16.758192 11.837373  9.365771</code></pre>
</div>
</div>
</section>
<section id="introducing-missingness-in-use" class="level3">
<h3 class="anchored" data-anchor-id="introducing-missingness-in-use">Introducing Missingness in <code>use</code></h3>
<p>Finally, we define and apply the missing data model for <code>use</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>M_use_intercept <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>M_use_female <span class="ot">=</span> .<span class="dv">5</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>M_use_msc <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>M_use_mas <span class="ot">=</span> .<span class="dv">02</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>M_use_mse <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>missingUSEmodelLogit <span class="ot">=</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  M_use_intercept <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  M_use_female<span class="sc">*</span>allx[,<span class="st">"female"</span>] <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  M_use_msc<span class="sc">*</span>allx[,<span class="st">"msc"</span>] <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  M_use_mas<span class="sc">*</span>allx[,<span class="st">"mas"</span>] <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  M_use_mse<span class="sc">*</span>allx[,<span class="st">"mse"</span>]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>missingUSEmodelProb <span class="ot">=</span> <span class="fu">exp</span>(missingUSEmodelLogit)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(missingUSEmodelLogit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Applying the model to introduce missing values in <code>use</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>makeMissingUse <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">runif</span>(Nmen<span class="sc">+</span>Nwomen) <span class="sc">&lt;</span> missingUSEmodelProb)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>use[makeMissingUse] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>allx<span class="sc">$</span>use</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  25.98603  57.94316  31.51112  49.23683  86.03307  49.83644  27.34231
  [8]        NA  57.59374  70.01668  44.48007  49.69265  57.65336  49.41270
 [15]  59.91785        NA  34.80138  96.48215  20.25779  33.61425  47.31303
 [22]        NA  39.34618        NA  55.66349  66.11912  37.38161  75.78362
 [29]  57.12786  54.32838  63.53114  54.11850  13.17825  21.08136  49.59362
 [36]  91.22713  64.22819  58.24329  59.86556  59.54157        NA  58.06283
 [43]  43.19457  52.17066  43.69302        NA        NA  18.74274  42.69099
 [50]  94.35209  58.98487  70.41901  45.44647        NA  53.56132  56.56360
 [57]  61.43773  68.00276        NA        NA        NA  62.42024  36.09353
 [64]  62.78615  44.15615  47.06736  47.92966  27.89581        NA  61.95347
 [71]  76.98301  27.90086  64.01986  55.22360  45.70850  41.97154  78.01587
 [78]  67.51520  42.53303        NA  43.13805        NA  72.99267  48.33413
 [85]        NA  52.75999        NA        NA  67.39213  77.35434  44.20284
 [92]  39.05459  69.43056  39.46969  54.24935  50.73233        NA  59.20456
 [99]  50.44884        NA  25.00361        NA  72.91814  22.79541  23.49984
[106]  58.85973  62.75545  17.59428        NA  35.52535  51.08052        NA
[113]  60.60145  57.22317  35.13498  45.27695  85.59726  47.38416        NA
[120]  44.55703  47.76403  64.57465  41.97907  40.11014        NA  60.30138
[127]  23.65381  34.48606  43.37461  51.13824  59.24258        NA  46.97206
[134]  31.03877  84.09366  45.49572  69.83184  53.83889  57.40198        NA
[141]  34.03711  62.94533  17.25072  44.12457  68.39509  51.37247  32.22518
[148]        NA  74.70326  58.03298  69.38816        NA  56.33521  36.08264
[155]        NA  64.40656        NA  71.21015  57.08863  39.28833  64.31976
[162]  69.00922        NA  62.26705  53.32167        NA  18.23179  66.52969
[169]        NA        NA  44.39014  59.19648  51.16867  44.24391  50.90536
[176]  40.16322  47.69272        NA  54.51617  55.61958  59.72962  47.00937
[183]        NA  25.74983  42.61128  36.05553  26.56331  41.52856  64.48250
[190]  64.12590  53.47216  53.20361        NA        NA  29.71283  64.25734
[197]        NA        NA  49.31666  36.10886  20.57751        NA  29.60830
[204]  12.46264  53.49363        NA  51.26203  54.70825  59.09609        NA
[211]        NA  72.33259        NA  57.32283  66.09566  65.08258  53.04131
[218]        NA  63.60225  27.13580        NA        NA  74.08107  62.58268
[225]  42.32239  39.04382  31.48064  26.58099  38.73084  30.92043        NA
[232]  45.52906  28.75810  61.15427  34.97287  35.72148  39.27290  48.42687
[239]  52.55787  61.29553  25.66332  41.43011  40.98506  44.52377  63.22256
[246]  47.45736  77.41504  39.84078  43.43498  52.59358  68.06403  47.78566
[253]  64.46720  34.37907  73.10910  54.75353  47.39750        NA  40.70835
[260]        NA  30.49188  35.39790        NA  63.15291  32.96431        NA
[267]  43.21773        NA        NA        NA  49.42643        NA  72.97730
[274]  58.83835        NA  52.99675 106.56918        NA  39.83700  59.44301
[281]  38.65360  59.88584  12.74757  57.00097  59.87038  60.50245  58.84270
[288]  43.33702  42.07626        NA        NA  51.87161  49.24108  58.63862
[295]  57.15762  32.34015  35.70952        NA        NA  12.47632        NA
[302]  71.44753  41.48316  38.31634        NA  68.66190  61.32496  43.70253
[309]  48.27531  42.79502  49.01786  38.58815  23.12677  36.91781  79.25350
[316]  62.17726  31.54420  20.91091        NA  59.56096        NA  21.65628
[323]  67.20952  68.70452  66.74332  45.87015        NA  53.00691  95.33053
[330]  65.55181  92.21331        NA        NA  57.02761        NA        NA
[337]        NA  47.53438  22.15236  40.85540  64.25376  52.05446  74.45331
[344]  26.36124  64.01290        NA  57.23752  57.50460  27.45201  52.93909</code></pre>
</div>
</div>
</section>
<section id="converting-the-data-into-a-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-the-data-into-a-data-frame">Converting the Data into a Data Frame</h3>
<p>Finally, we store the modified dataset in a new data frame for further analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data02 <span class="ot">=</span> <span class="fu">as.data.frame</span>(allx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="centering-cc-and-initial-data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="centering-cc-and-initial-data-exploration">Centering <code>cc</code> and Initial Data Exploration</h2>
<p>To improve interpretability, we center the <code>cc</code> variable at 10 and create an interaction term between <code>female</code> and <code>cc10</code>.</p>
<section id="visualizing-cc" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-cc">Visualizing <code>cc</code></h3>
<p>We first generate a boxplot and a histogram to examine the distribution of <code>cc</code> before centering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data02<span class="sc">$</span>cc, <span class="at">main=</span><span class="st">"Boxplot of College Experience (CC)"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data02<span class="sc">$</span>cc, <span class="at">main =</span> <span class="st">"Histogram of College Experience (CC)"</span>, <span class="at">xlab =</span> <span class="st">"CC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="centering-cc" class="level3">
<h3 class="anchored" data-anchor-id="centering-cc">Centering <code>cc</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data02<span class="sc">$</span>cc10 <span class="ot">=</span> data02<span class="sc">$</span>cc <span class="sc">-</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-an-interaction-term" class="level3">
<h3 class="anchored" data-anchor-id="creating-an-interaction-term">Creating an Interaction Term</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data02<span class="sc">$</span>femXcc10 <span class="ot">=</span> data02<span class="sc">$</span>female<span class="sc">*</span>data02<span class="sc">$</span>cc10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-data-for-analysis" class="level3">
<h3 class="anchored" data-anchor-id="preparing-data-for-analysis">Preparing Data for Analysis</h3>
<p>We create a subset of the dataset including only relevant variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">=</span> data02[<span class="fu">c</span>(<span class="st">"perf"</span>, <span class="st">"use"</span>, <span class="st">"female"</span>, <span class="st">"cc10"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-for-completely-missing-rows" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-completely-missing-rows">Checking for Completely Missing Rows</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>allNA <span class="ot">=</span> <span class="fu">apply</span>(newData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">all</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(allNA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<p>No observations are missing all variables, so we proceed.</p>
</section>
</section>
<section id="building-analysis-model-1-empty-model" class="level2">
<h2 class="anchored" data-anchor-id="building-analysis-model-1-empty-model">Building Analysis Model #1: Empty Model</h2>
<p>This model estimates the means, variances, and covariance of <code>perf</code> and <code>use</code> without predictors.</p>
<section id="checking-missing-data-patterns" class="level3">
<h3 class="anchored" data-anchor-id="checking-missing-data-patterns">Checking Missing Data Patterns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(newData<span class="sc">$</span>perf) <span class="sc">&amp;</span> <span class="fu">is.na</span>(newData<span class="sc">$</span>use))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(newData<span class="sc">$</span>perf) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(newData<span class="sc">$</span>use))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 338</code></pre>
</div>
</div>
</section>
<section id="defining-the-model-syntax" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-model-syntax">Defining the Model Syntax</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>model01.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="st">#Means:</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="st">#Variances:</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="st">#Covariance:</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-estimation-using-lavaan" class="level3">
<h3 class="anchored" data-anchor-id="model-estimation-using-lavaan">Model Estimation Using <code>lavaan</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model01.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model01.syntax, <span class="at">data=</span>data02, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some cases are empty and will be ignored: 61 85 125 140 155 157 210 211 
   213 272 299 346.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model01.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 29 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

                                                  Used       Total
  Number of observations                           338         350
  Number of missing patterns                         3            

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                                10.038      12.196
  Degrees of freedom                                 1           1
  P-value                                        0.002       0.000
  Scaling correction factor                                  0.823

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1829.062   -1829.062
  Loglikelihood unrestricted model (H1)      -1829.062   -1829.062
                                                                  
  Akaike (AIC)                                3668.125    3668.125
  Bayesian (BIC)                              3687.240    3687.240
  Sample-size adjusted Bayesian (SABIC)       3671.379    3671.379

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~~                                                               
    use               9.908    2.776    3.569    0.000    9.908    0.209

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perf             13.837    0.173   79.878    0.000   13.837    4.838
    use              50.802    0.999   50.834    0.000   50.802    3.062

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perf              8.179    0.677   12.077    0.000    8.179    1.000
    use             275.265   24.557   11.209    0.000  275.265    1.000</code></pre>
</div>
</div>
</section>
<section id="comparing-model-implied-and-observed-covariance-matrices" class="level3">
<h3 class="anchored" data-anchor-id="comparing-model-implied-and-observed-covariance-matrices">Comparing Model-Implied and Observed Covariance Matrices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model01.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
        perf     use
perf   8.179        
use    9.908 275.265

$mean
  perf    use 
13.837 50.802 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>meanVec <span class="ot">=</span> <span class="fu">colMeans</span>(data02[<span class="fu">c</span>(<span class="st">"perf"</span>, <span class="st">"use"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>meanVec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    perf      use 
13.84260 50.61093 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(data02[<span class="fu">c</span>(<span class="st">"perf"</span>, <span class="st">"use"</span>)], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          perf       use
perf  8.601417  10.83042
use  10.830424 287.89536</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(newData<span class="sc">$</span>perf) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(newData<span class="sc">$</span>use))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>covMat <span class="ot">=</span> <span class="fu">cov</span>(data02[<span class="fu">c</span>(<span class="st">"perf"</span>, <span class="st">"use"</span>)], <span class="at">use =</span> <span class="st">"complete.obs"</span>)<span class="sc">*</span>(N<span class="dv">-1</span>)<span class="sc">/</span>N</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>covMat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          perf       use
perf  8.575969  10.79838
use  10.798382 287.04360</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-residuals" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-residuals">Inspecting Model Residuals</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model01.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
        perf     use
perf   8.179        
use    9.908 275.265

$mean
  perf    use 
13.837 50.802 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model01.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
     perf use
perf    0    
use     0   0

$mean
perf  use 
   0    0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model01.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
     perf use
perf    0    
use     0   0

$mean
perf  use 
   0    0 </code></pre>
</div>
</div>
</section>
<section id="checking-r-squared-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-r-squared-values">Checking R-Squared Values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model01.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model">Visualizing the Model</h3>
<p>We generate path diagrams to visualize the estimated relationships.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model01.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model01.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="verifying-log-likelihood-calculation" class="level2">
<h2 class="anchored" data-anchor-id="verifying-log-likelihood-calculation">Verifying Log-Likelihood Calculation</h2>
<p>In this section, we compare the log-likelihood calculated manually with the one obtained from <code>lavaan</code> to confirm that they match.</p>
<section id="manual-log-likelihood-calculation" class="level3">
<h3 class="anchored" data-anchor-id="manual-log-likelihood-calculation">Manual Log-Likelihood Calculation</h3>
<p>We first extract complete cases and compute the log-likelihood manually:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>completeData <span class="ot">=</span> data02[, <span class="fu">c</span>(<span class="st">"perf"</span>, <span class="st">"use"</span>)]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove cases that are missing on all variables</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>completeData <span class="ot">=</span> completeData[<span class="sc">!</span><span class="fu">is.na</span>(completeData<span class="sc">$</span>perf) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(completeData<span class="sc">$</span>use),]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>logLike <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(completeData))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(completeData)){</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  obsData <span class="ot">=</span> completeData[obs,]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  obsVars <span class="ot">=</span> <span class="fu">names</span>(completeData)[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(obsData))]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  logLike[obs] <span class="ot">=</span> <span class="fu">dmvnorm</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> obsData[obsVars], </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> meanVec[obsVars], </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma =</span> covMat[obsVars, obsVars, <span class="at">drop=</span><span class="cn">FALSE</span>], </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="cn">TRUE</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># our calculation</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(logLike)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1829.344</code></pre>
</div>
</div>
</section>
<section id="log-likelihood-from-lavaan" class="level3">
<h3 class="anchored" data-anchor-id="log-likelihood-from-lavaan">Log-Likelihood from <code>lavaan</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">inspect</span>(model01.fit, <span class="at">what=</span><span class="st">"loglik.casewise"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1829.062</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-factored-regression-specifications" class="level2">
<h2 class="anchored" data-anchor-id="comparing-factored-regression-specifications">Comparing Factored Regression Specifications</h2>
<p>We now compare different factored regression specifications to confirm they yield the same log-likelihood.</p>
<section id="model-1b-perf-use-and-use-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1b-perf-use-and-use-1">Model 1b: <code>perf ~ use</code> and <code>use ~ 1</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>model01b.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="st"># exogenous mean:</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="st">use ~ 1</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="st"># exogenous variance:</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="st">use ~~ use</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="st"># regression:</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + use</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="st"># residual variance:</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>model01b.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model01b.syntax, <span class="at">data=</span>data02, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some cases are empty and will be ignored: 61 85 125 140 155 157 210 211 
   213 272 299 346.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model01b.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 16 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

                                                  Used       Total
  Number of observations                           338         350
  Number of missing patterns                         3            

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                                10.038      12.196
  Degrees of freedom                                 1           1
  P-value                                        0.002       0.000
  Scaling correction factor                                  0.823

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1829.062   -1829.062
  Loglikelihood unrestricted model (H1)      -1829.062   -1829.062
                                                                  
  Akaike (AIC)                                3668.125    3668.125
  Bayesian (BIC)                              3687.240    3687.240
  Sample-size adjusted Bayesian (SABIC)       3671.379    3671.379

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    use               0.036    0.010    3.648    0.000    0.036    0.209

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    use              50.802    0.999   50.834    0.000   50.802    3.062
   .perf             12.008    0.527   22.766    0.000   12.008    4.199

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    use             275.265   24.557   11.209    0.000  275.265    1.000
   .perf              7.822    0.670   11.682    0.000    7.822    0.956</code></pre>
</div>
</div>
</section>
<section id="model-1c-use-perf-and-perf-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1c-use-perf-and-perf-1">Model 1c: <code>use ~ perf</code> and <code>perf ~ 1</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>model01c.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="st"># exogenous mean:</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="st"># exogenous variance:</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="st"># regression:</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="st">use ~ 1 + perf</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="st"># residual variance:</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="st">use ~~ use</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>model01c.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model01c.syntax, <span class="at">data=</span>data02, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some cases are empty and will be ignored: 61 85 125 140 155 157 210 211 
   213 272 299 346.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model01c.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

                                                  Used       Total
  Number of observations                           338         350
  Number of missing patterns                         3            

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                                10.038      12.196
  Degrees of freedom                                 1           1
  P-value                                        0.002       0.000
  Scaling correction factor                                  0.823

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1829.062   -1829.062
  Loglikelihood unrestricted model (H1)      -1829.062   -1829.062
                                                                  
  Akaike (AIC)                                3668.125    3668.125
  Bayesian (BIC)                              3687.240    3687.240
  Sample-size adjusted Bayesian (SABIC)       3671.379    3671.379

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  use ~                                                                 
    perf              1.211    0.337    3.590    0.000    1.211    0.209

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perf             13.837    0.173   79.878    0.000   13.837    4.838
   .use              34.040    4.679    7.275    0.000   34.040    2.052

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perf              8.179    0.677   12.077    0.000    8.179    1.000
   .use             263.262   23.850   11.038    0.000  263.262    0.956</code></pre>
</div>
</div>
</section>
</section>
<section id="model-2-adding-predictors-as-main-effects" class="level2">
<h2 class="anchored" data-anchor-id="model-2-adding-predictors-as-main-effects">Model 2: Adding Predictors as Main Effects</h2>
<p>In this section, we expand our analysis by adding predictors (<code>female</code> and <code>cc10</code>) as main effects in the regression models for <code>perf</code> and <code>use</code>.</p>
<section id="specifying-the-model-syntax" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-model-syntax">Specifying the Model Syntax</h3>
<p>We define a structural equation model where <code>perf</code> and <code>use</code> are regressed on <code>female</code> and <code>cc10</code>. The variances and covariances of <code>perf</code> and <code>use</code> are also estimated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>model02.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="st">#Means:</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + female + cc10</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1 + female + cc10</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="st">#Variances:</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">#Covariance:</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-the-model" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-model">Estimating the Model</h3>
<p>We fit the model using the <code>lavaan</code> package with the <code>MLR</code> estimator and <code>MPLUS</code> mimic settings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>model02.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model02.syntax, <span class="at">data=</span>data02, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   105 cases were deleted due to missing values in exogenous variable(s), 
   while fixed.x = TRUE.</code></pre>
</div>
</div>
</section>
<section id="summarizing-the-model-results" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-model-results">Summarizing the Model Results</h3>
<p>We generate a summary of the model fit, including standardized estimates and fit indices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model02.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 46 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9

                                                  Used       Total
  Number of observations                           245         350
  Number of missing patterns                         4            

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                                30.301      31.752
  Degrees of freedom                                 5           5
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.954

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1275.323   -1275.323
  Loglikelihood unrestricted model (H1)      -1275.323   -1275.323
                                                                  
  Akaike (AIC)                                2568.645    2568.645
  Bayesian (BIC)                              2600.157    2600.157
  Sample-size adjusted Bayesian (SABIC)       2571.627    2571.627

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    female           -1.586    0.384   -4.135    0.000   -1.586   -0.275
    cc10              0.081    0.030    2.721    0.007    0.081    0.192
  use ~                                                                 
    female           -0.824    2.598   -0.317    0.751   -0.824   -0.023
    cc10             -0.025    0.171   -0.145    0.885   -0.025   -0.009

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .perf ~~                                                               
   .use               8.676    3.326    2.608    0.009    8.676    0.190

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .perf             14.541    0.291   49.940    0.000   14.541    5.204
   .use              50.868    2.099   24.230    0.000   50.868    2.941

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .perf              6.943    0.706    9.840    0.000    6.943    0.889
   .use             298.866   32.836    9.102    0.000  298.866    0.999</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-implied-mean-vector-and-covariance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-implied-mean-vector-and-covariance-matrix">Inspecting Model-Implied Mean Vector and Covariance Matrix</h3>
<p>The <code>fitted()</code> function provides the expected mean vector and covariance matrix under the estimated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model02.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     7.809                        
use      8.895 299.055                
female  -0.369  -0.195   0.236        
cc10     3.447  -1.120   0.057  43.418

$mean
  perf    use female   cc10 
13.528 50.365  0.620 -0.352 </code></pre>
</div>
</div>
</section>
<section id="examining-the-saturated-model-statistics" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-saturated-model-statistics">Examining the Saturated Model Statistics</h3>
<p>The <code>inspect()</code> function allows us to see the sample statistics from the fully saturated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model02.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     7.809                        
use      8.895 299.055                
female  -0.369  -0.195   0.236        
cc10     3.447  -1.120   0.057  43.418

$mean
  perf    use female   cc10 
13.528 50.365  0.620 -0.352 </code></pre>
</div>
</div>
</section>
<section id="assessing-residuals" class="level3">
<h3 class="anchored" data-anchor-id="assessing-residuals">Assessing Residuals</h3>
<p>We check the raw residuals to assess the discrepancy between model-implied and observed covariance structures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model02.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       perf use female cc10
perf      0                
use       0   0            
female    0   0      0     
cc10      0   0      0    0

$mean
  perf    use female   cc10 
     0      0      0      0 </code></pre>
</div>
</div>
<p>We also examine the normalized residuals to further evaluate model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model02.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       perf use female cc10
perf      0                
use       0   0            
female    0   0      0     
cc10      0   0      0    0

$mean
  perf    use female   cc10 
     0      0      0      0 </code></pre>
</div>
</div>
</section>
<section id="checking-modification-indices" class="level3">
<h3 class="anchored" data-anchor-id="checking-modification-indices">Checking Modification Indices</h3>
<p>The <code>modindices()</code> function provides information about potential model improvements by suggesting additional parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(model02.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] lhs      op       rhs      mi       epc      sepc.lv  sepc.all sepc.nox
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</section>
<section id="calculating-r-squared-values-for-dependent-variables" class="level3">
<h3 class="anchored" data-anchor-id="calculating-r-squared-values-for-dependent-variables">Calculating R-Squared Values for Dependent Variables</h3>
<p>We inspect the proportion of variance explained for the dependent variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model02.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> perf   use 
0.111 0.001 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model-1">Visualizing the Model</h3>
<p>Finally, we create path diagrams to illustrate the relationships in the estimated model.</p>
<section id="path-diagram-without-estimates" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-without-estimates">Path Diagram Without Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model02.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="path-diagram-with-estimates" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-with-estimates">Path Diagram With Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model02.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="model-3-expanding-the-likelihood-function" class="level2">
<h2 class="anchored" data-anchor-id="model-3-expanding-the-likelihood-function">Model 3: Expanding the Likelihood Function</h2>
<p>In this section, we expand the likelihood function by incorporating more variables into the estimation process.</p>
<section id="specifying-the-model-syntax-1" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-model-syntax-1">Specifying the Model Syntax</h3>
<p>This model includes <code>cc10</code> as an exogenous variable and estimates its mean and variance. We also specify regressions for <code>perf</code> and <code>use</code> with <code>female</code> and <code>cc10</code> as predictors, while maintaining variance and covariance structures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>model03.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Exogenous Variables </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="st">#Mean:</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~ 1</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="st">#Variance:</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ cc10</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Endogenous Variables </span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="st">#Regressions:</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + female + cc10</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1 + female + cc10</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Variances:</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Covariance:</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-model-1">Estimating the Model</h3>
<p>We fit the expanded model using <code>lavaan</code>, ensuring that there are no warnings related to missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>model03.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model03.syntax, <span class="at">data=</span>data02, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarizing-the-model-results-1" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-model-results-1">Summarizing the Model Results</h3>
<p>We extract and examine the model summary, including standardized estimates and fit measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model03.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 53 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        11

  Number of observations                           350
  Number of missing patterns                         8

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.157       0.148
  Degrees of freedom                                 1           1
  P-value (Chi-square)                           0.692       0.700
  Scaling correction factor                                  1.059
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                                32.478      33.840
  Degrees of freedom                                 6           6
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.960

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.191       1.184
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.181

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2627.493   -2627.493
  Scaling correction factor                                  0.970
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -2627.415   -2627.415
  Scaling correction factor                                  0.978
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                5276.987    5276.987
  Bayesian (BIC)                              5319.424    5319.424
  Sample-size adjusted Bayesian (SABIC)       5284.528    5284.528

Root Mean Square Error of Approximation:

  RMSEA                                          0.000       0.000
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.105       0.099
  P-value H_0: RMSEA &lt;= 0.050                    0.797       0.816
  P-value H_0: RMSEA &gt;= 0.080                    0.106       0.092
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.125
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.775
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.144

Standardized Root Mean Square Residual:

  SRMR                                           0.007       0.007

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    female           -1.334    0.338   -3.944    0.000   -1.334   -0.222
    cc10              0.088    0.031    2.847    0.004    0.088    0.204
  use ~                                                                 
    female           -2.036    2.108   -0.966    0.334   -2.036   -0.058
    cc10             -0.007    0.156   -0.048    0.962   -0.007   -0.003

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .perf ~~                                                               
   .use               9.385    2.761    3.399    0.001    9.385    0.208

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             -0.227    0.424   -0.535    0.593   -0.227   -0.034
   .perf             14.712    0.261   56.287    0.000   14.712    5.145
   .use              52.122    1.721   30.284    0.000   52.122    3.140

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             43.505    3.841   11.326    0.000   43.505    1.000
   .perf              7.436    0.634   11.734    0.000    7.436    0.909
   .use             274.517   24.516   11.197    0.000  274.517    0.997</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-implied-mean-vector-and-covariance-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-implied-mean-vector-and-covariance-matrix-1">Inspecting Model-Implied Mean Vector and Covariance Matrix</h3>
<p>We check the expected mean vector and covariance matrix under the estimated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model03.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     8.177                        
use      9.971 275.457                
female  -0.302  -0.461   0.226        
cc10     3.841  -0.324   0.000  43.505

$mean
  perf    use female   cc10 
13.819 50.792  0.654 -0.227 </code></pre>
</div>
</div>
</section>
<section id="examining-the-saturated-model-statistics-1" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-saturated-model-statistics-1">Examining the Saturated Model Statistics</h3>
<p>We inspect the sample statistics from the fully saturated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model03.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     8.163                        
use      9.950 275.464                
female  -0.297  -0.461   0.226        
cc10     3.755  -0.576   0.078  43.520

$mean
  perf    use female   cc10 
13.819 50.791  0.654 -0.215 </code></pre>
</div>
</div>
</section>
<section id="assessing-residuals-1" class="level3">
<h3 class="anchored" data-anchor-id="assessing-residuals-1">Assessing Residuals</h3>
<p>We evaluate the raw residuals to assess model fit discrepancies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model03.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
         perf    use female   cc10
perf   -0.014                     
use    -0.021  0.007              
female  0.005 -0.001  0.000       
cc10   -0.086 -0.252  0.078  0.015

$mean
  perf    use female   cc10 
 0.000  0.000  0.000  0.012 </code></pre>
</div>
</div>
<p>We also check the normalized residuals for further model diagnostics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model03.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
         perf    use female   cc10
perf   -0.021                     
use    -0.008  0.000              
female  0.066 -0.001  0.000       
cc10   -0.062 -0.037  0.385  0.004

$mean
  perf    use female   cc10 
 0.000  0.000  0.000  0.028 </code></pre>
</div>
</div>
</section>
<section id="checking-modification-indices-1" class="level3">
<h3 class="anchored" data-anchor-id="checking-modification-indices-1">Checking Modification Indices</h3>
<p>The <code>modindices()</code> function suggests potential model improvements by identifying additional parameters to estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(model03.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      lhs op    rhs    mi    epc sepc.lv sepc.all sepc.nox
18 female  ~   perf 0.163  0.021   0.021    0.126    0.126
19 female  ~    use 0.163 -0.248  -0.248   -8.665   -8.665
20 female  ~   cc10 0.163  0.002   0.002    0.026    0.002
21   cc10  ~   perf 0.163 -0.267  -0.267   -0.116   -0.116
22   cc10  ~    use 0.163 -0.175  -0.175   -0.440   -0.440
23   cc10  ~ female 0.163  0.356   0.356    0.026    0.054</code></pre>
</div>
</div>
</section>
<section id="calculating-r-squared-values-for-dependent-variables-1" class="level3">
<h3 class="anchored" data-anchor-id="calculating-r-squared-values-for-dependent-variables-1">Calculating R-Squared Values for Dependent Variables</h3>
<p>We compute the proportion of variance explained for the dependent variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model03.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> perf   use 
0.091 0.003 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-2" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model-2">Visualizing the Model</h3>
<p>We generate path diagrams to illustrate the estimated relationships.</p>
<section id="path-diagram-without-estimates-1" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-without-estimates-1">Path Diagram Without Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model03.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="path-diagram-with-estimates-1" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-with-estimates-1">Path Diagram With Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model03.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="handling-missing-data-in-a-categorical-variable-female" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-in-a-categorical-variable-female">Handling Missing Data in a Categorical Variable (<code>female</code>)</h2>
<p>We introduce missingness in <code>female</code> completely at random (MCAR) to assess its impact on model estimation.</p>
<section id="creating-missing-values-in-female" class="level3">
<h3 class="anchored" data-anchor-id="creating-missing-values-in-female">Creating Missing Values in <code>female</code></h3>
<p>We randomly introduce missing values in 10% of observations for <code>female</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>data03 <span class="ot">=</span> data02</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>data03<span class="sc">$</span>female[<span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data03), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> .<span class="dv">1</span><span class="sc">*</span><span class="fu">nrow</span>(data03) )] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>data03<span class="sc">$</span>female</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 NA  0  0 NA NA  0  0
 [26] NA  0  0  0  0  0  0  0  0  0  0  0  0 NA  0  0  0  0  0  0  0  0  0  0  0
 [51]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 NA  0  0  0  0  0  0  0  0
 [76]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 NA  0  0  0  0
[101]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 NA  0  0  0  0  1  1  1  1
[126]  1  1  1 NA  1  1  1  1  1  1  1  1 NA  1  1 NA  1  1  1  1  1  1  1  1  1
[151]  1  1  1 NA  1  1 NA  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
[176]  1  1  1  1  1  1  1 NA  1  1  1  1  1  1  1  1  1  1 NA  1  1  1  1 NA  1
[201]  1  1  1  1  1  1  1  1  1  1  1 NA  1  1  1  1  1 NA  1  1  1  1  1  1  1
[226] NA  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1 NA
[251]  1  1  1  1  1  1  1  1  1  1 NA  1 NA  1  1  1  1  1  1  1  1  1 NA  1  1
[276]  1  1  1  1  1  1  1  1  1  1  1  1  1  1 NA NA NA  1  1  1  1  1  1  1  1
[301]  1  1  1  1  1  1 NA  1  1  1  1 NA  1  1  1  1  1  1  1 NA NA  1  1  1  1
[326]  1  1  1  1  1 NA  1  1  1  1  1  1 NA  1 NA  1  1  1  1  1  1  1  1  1  1</code></pre>
</div>
</div>
</section>
<section id="running-the-model-with-missing-female" class="level3">
<h3 class="anchored" data-anchor-id="running-the-model-with-missing-female">Running the Model with Missing <code>female</code></h3>
<p>We attempt to estimate <code>model03.syntax</code> on the modified dataset, expecting a warning about missing data since <code>female</code> is not explicitly included in the likelihood function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>model03b.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model03.syntax, <span class="at">data=</span>data03, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   33 cases were deleted due to missing values in exogenous variable(s), 
   while fixed.x = TRUE.</code></pre>
</div>
</div>
</section>
</section>
<section id="model-4-adding-female-to-the-likelihood-function" class="level2">
<h2 class="anchored" data-anchor-id="model-4-adding-female-to-the-likelihood-function">Model 4: Adding <code>female</code> to the Likelihood Function</h2>
<p>In this section, we extend the likelihood function to explicitly model <code>female</code> as an exogenous variable alongside <code>cc10</code>.</p>
<section id="specifying-the-model-syntax-2" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-model-syntax-2">Specifying the Model Syntax</h3>
<p>This model includes <code>female</code> as an exogenous variable, estimating its mean and variance, as well as its covariance with <code>cc10</code>. The endogenous variables <code>perf</code> and <code>use</code> are regressed on both <code>female</code> and <code>cc10</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>model04.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Exogenous Variables </span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="st">#Mean:</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~ 1</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="st">female ~ 1</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="st">#Variance:</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ cc10</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="st">female ~~ female</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="st">#Covariance:</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ female</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="st"># Endogenous Variables </span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="st">#Regressions:</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + female + cc10</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1 + female + cc10</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Variances:</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Covariance:</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-the-model-2" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-model-2">Estimating the Model</h3>
<p>We fit the model using <code>lavaan</code>, incorporating <code>female</code> into the likelihood function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model04.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model04.syntax, <span class="at">data=</span>data03, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some observed variances are (at least) a factor 1000 times larger than 
   others; use varTable(fit) to investigate</code></pre>
</div>
</div>
</section>
<section id="summarizing-the-model-results-2" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-model-results-2">Summarizing the Model Results</h3>
<p>We extract and examine the model summary, including standardized estimates and fit measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model04.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 57 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                           350
  Number of missing patterns                        15

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                                33.239      34.571
  Degrees of freedom                                 6           6
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.961

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2843.479   -2843.479
  Loglikelihood unrestricted model (H1)      -2843.479   -2843.479
                                                                  
  Akaike (AIC)                                5714.958    5714.958
  Bayesian (BIC)                              5768.969    5768.969
  Sample-size adjusted Bayesian (SABIC)       5724.556    5724.556

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    female           -1.423    0.348   -4.091    0.000   -1.423   -0.238
    cc10              0.089    0.031    2.840    0.005    0.089    0.205
  use ~                                                                 
    female           -1.917    2.202   -0.871    0.384   -1.917   -0.055
    cc10             -0.010    0.156   -0.066    0.948   -0.010   -0.004

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  female ~~                                                             
    cc10              0.103    0.209    0.493    0.622    0.103    0.033
 .perf ~~                                                               
   .use               9.374    2.794    3.355    0.001    9.374    0.208

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             -0.211    0.423   -0.498    0.618   -0.211   -0.032
    female            0.643    0.027   23.967    0.000    0.643    1.344
   .perf             14.757    0.263   56.183    0.000   14.757    5.165
   .use              52.026    1.746   29.800    0.000   52.026    3.135

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             43.500    3.838   11.335    0.000   43.500    1.000
    female            0.229    0.008   29.729    0.000    0.229    1.000
   .perf              7.382    0.633   11.653    0.000    7.382    0.904
   .use             274.611   24.485   11.215    0.000  274.611    0.997</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-implied-mean-vector-and-covariance-matrix-2" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-implied-mean-vector-and-covariance-matrix-2">Inspecting Model-Implied Mean Vector and Covariance Matrix</h3>
<p>We check the expected mean vector and covariance matrix under the estimated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model04.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     8.162                        
use      9.943 275.462                
female  -0.317  -0.440   0.229        
cc10     3.711  -0.645   0.103  43.500

$mean
  perf    use female   cc10 
13.823 50.795  0.643 -0.211 </code></pre>
</div>
</div>
</section>
<section id="examining-the-saturated-model-statistics-2" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-saturated-model-statistics-2">Examining the Saturated Model Statistics</h3>
<p>We inspect the sample statistics from the fully saturated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model04.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10
perf     8.162                        
use      9.943 275.462                
female  -0.317  -0.440   0.229        
cc10     3.711  -0.645   0.103  43.500

$mean
  perf    use female   cc10 
13.823 50.795  0.643 -0.211 </code></pre>
</div>
</div>
</section>
<section id="assessing-residuals-2" class="level3">
<h3 class="anchored" data-anchor-id="assessing-residuals-2">Assessing Residuals</h3>
<p>We evaluate the raw residuals to assess model fit discrepancies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model04.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       perf use female cc10
perf      0                
use       0   0            
female    0   0      0     
cc10      0   0      0    0

$mean
  perf    use female   cc10 
     0      0      0      0 </code></pre>
</div>
</div>
<p>We also check the normalized residuals for further model diagnostics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model04.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       perf use female cc10
perf      0                
use       0   0            
female    0   0      0     
cc10      0   0      0    0

$mean
  perf    use female   cc10 
     0      0      0      0 </code></pre>
</div>
</div>
</section>
<section id="checking-modification-indices-2" class="level3">
<h3 class="anchored" data-anchor-id="checking-modification-indices-2">Checking Modification Indices</h3>
<p>The <code>modindices()</code> function suggests potential model improvements by identifying additional parameters to estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(model04.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] lhs      op       rhs      mi       epc      sepc.lv  sepc.all sepc.nox
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</section>
<section id="calculating-r-squared-values-for-dependent-variables-2" class="level3">
<h3 class="anchored" data-anchor-id="calculating-r-squared-values-for-dependent-variables-2">Calculating R-Squared Values for Dependent Variables</h3>
<p>We compute the proportion of variance explained for the dependent variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model04.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> perf   use 
0.096 0.003 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-3" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model-3">Visualizing the Model</h3>
<p>We generate path diagrams to illustrate the estimated relationships.</p>
<section id="path-diagram-without-estimates-2" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-without-estimates-2">Path Diagram Without Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model04.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="path-diagram-with-estimates-2" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-with-estimates-2">Path Diagram With Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model04.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="addressing-the-normality-issue-with-female" class="level3">
<h3 class="anchored" data-anchor-id="addressing-the-normality-issue-with-female">Addressing the Normality Issue with <code>female</code></h3>
<p>Since <code>female</code> is not normally distributed, we will need to use factored regression and the EM algorithm to correct for this issue in subsequent models.</p>
</section>
</section>
<section id="handling-non-normal-female-using-factored-regression-and-the-em-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="handling-non-normal-female-using-factored-regression-and-the-em-algorithm">Handling Non-Normal <code>female</code> Using Factored Regression and the EM Algorithm</h2>
<p>In this section, we use factored regression and the Expectation-Maximization (EM) algorithm to handle the non-normal distribution of <code>female</code>. The factorization follows:</p>
<p><span class="math display">\[f(use, perf, cc10, female) = f(use|perf, cc10, female) * f(perf|cc10, female) * f(cc10|female) * f(female)\]</span></p>
<section id="initializing-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="initializing-model-parameters">Initializing Model Parameters</h3>
<p>We set initial values for the regression coefficients in the factored regression framework.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f(female):</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>female_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># f(cc10|female) </span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>cc10_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>cc10_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># f(perf|cc10, female):</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>perf_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>perf_cc10 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>perf_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co"># f(use|perf, cc10, female):</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>use_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>use_perf <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>use_cc10 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>use_female <span class="ot">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identifying-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="identifying-missing-data">Identifying Missing Data</h3>
<p>We determine which observations have missing values in each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>femaleMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>female))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>cc10Missing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>cc10))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>perfMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>perf))</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>useMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>use))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-the-em-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-em-algorithm">Setting Up the EM Algorithm</h3>
<p>We create a working copy of the dataset and set the number of iterations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>algorithmData <span class="ot">=</span> data03</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>maxIterations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>iteration <span class="ot">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="em-algorithm-expectation-and-maximization-steps" class="level3">
<h3 class="anchored" data-anchor-id="em-algorithm-expectation-and-maximization-steps">EM Algorithm: Expectation and Maximization Steps</h3>
<p>We iterate through the EM process, imputing missing data in the E-step and re-estimating parameters in the M-step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(iteration <span class="sc">&lt;</span> maxIterations){</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># E-step: Impute missing values</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>female[femaleMissing] <span class="ot">=</span> </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">exp</span>(female_intercept)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(female_intercept)), <span class="dv">0</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>cc10[cc10Missing] <span class="ot">=</span> </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    cc10_intercept <span class="sc">+</span> </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    cc10_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[cc10Missing]</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>perf[perfMissing] <span class="ot">=</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    perf_intercept <span class="sc">+</span> </span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    perf_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[perfMissing] <span class="sc">+</span> </span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>    perf_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[perfMissing]</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>use[useMissing] <span class="ot">=</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>    use_intercept <span class="sc">+</span> </span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>    use_perf<span class="sc">*</span>algorithmData<span class="sc">$</span>perf[useMissing] <span class="sc">+</span> </span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>    use_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[useMissing] <span class="sc">+</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>    use_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[useMissing]</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M-step: Update regression coefficients</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>  femaleModel <span class="ot">=</span> <span class="fu">glm</span>(female <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> algorithmData, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>  female_intercept <span class="ot">=</span> femaleModel<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>  logLikeFemale <span class="ot">=</span> <span class="fu">dbinom</span>(</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> algorithmData<span class="sc">$</span>female, </span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">exp</span>(female_intercept)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(female_intercept)), </span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="cn">TRUE</span></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>  cc10Model <span class="ot">=</span> <span class="fu">lm</span>(cc10 <span class="sc">~</span> female, <span class="at">data =</span> algorithmData)</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>  cc10_intercept <span class="ot">=</span> cc10Model<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>  cc10_female <span class="ot">=</span> cc10Model<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a>  cc10_residVar <span class="ot">=</span> <span class="fu">anova</span>(cc10Model)<span class="sc">$</span><span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>  logLikeCC10 <span class="ot">=</span> <span class="fu">dnorm</span>(</span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> algorithmData<span class="sc">$</span>cc10, </span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> cc10_intercept <span class="sc">+</span> cc10_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female,</span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sqrt</span>(cc10_residVar),</span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="cn">TRUE</span></span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a>  perfModel <span class="ot">=</span> <span class="fu">lm</span>(perf <span class="sc">~</span> cc10 <span class="sc">+</span> female, <span class="at">data =</span> algorithmData)</span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a>  perf_intercept <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a>  perf_cc10 <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"cc10"</span>]</span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a>  perf_female <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a>  perf_residVar <span class="ot">=</span> <span class="fu">anova</span>(perfModel)<span class="sc">$</span><span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a>  logLikePerf <span class="ot">=</span> <span class="fu">dnorm</span>(</span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> algorithmData<span class="sc">$</span>perf, </span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> perf_intercept <span class="sc">+</span> perf_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10 <span class="sc">+</span> perf_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female,</span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sqrt</span>(perf_residVar),</span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="cn">TRUE</span></span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-53"><a href="#cb135-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-54"><a href="#cb135-54" aria-hidden="true" tabindex="-1"></a>  useModel <span class="ot">=</span> <span class="fu">lm</span>(use <span class="sc">~</span> perf <span class="sc">+</span> cc10 <span class="sc">+</span> female, <span class="at">data =</span> algorithmData)</span>
<span id="cb135-55"><a href="#cb135-55" aria-hidden="true" tabindex="-1"></a>  use_intercept <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb135-56"><a href="#cb135-56" aria-hidden="true" tabindex="-1"></a>  use_perf <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"perf"</span>]</span>
<span id="cb135-57"><a href="#cb135-57" aria-hidden="true" tabindex="-1"></a>  use_cc10 <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"cc10"</span>]</span>
<span id="cb135-58"><a href="#cb135-58" aria-hidden="true" tabindex="-1"></a>  use_female <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb135-59"><a href="#cb135-59" aria-hidden="true" tabindex="-1"></a>  use_residVar <span class="ot">=</span> <span class="fu">anova</span>(useModel)<span class="sc">$</span><span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb135-60"><a href="#cb135-60" aria-hidden="true" tabindex="-1"></a>  logLikeUse <span class="ot">=</span> <span class="fu">dnorm</span>(</span>
<span id="cb135-61"><a href="#cb135-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> algorithmData<span class="sc">$</span>use, </span>
<span id="cb135-62"><a href="#cb135-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> use_intercept <span class="sc">+</span> use_perf<span class="sc">*</span>algorithmData<span class="sc">$</span>perf <span class="sc">+</span> use_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10 <span class="sc">+</span> use_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female,</span>
<span id="cb135-63"><a href="#cb135-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sqrt</span>(use_residVar),</span>
<span id="cb135-64"><a href="#cb135-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="cn">TRUE</span></span>
<span id="cb135-65"><a href="#cb135-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-66"><a href="#cb135-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-67"><a href="#cb135-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute total log-likelihood</span></span>
<span id="cb135-68"><a href="#cb135-68" aria-hidden="true" tabindex="-1"></a>  logLikeMatrix <span class="ot">=</span> <span class="fu">cbind</span>(</span>
<span id="cb135-69"><a href="#cb135-69" aria-hidden="true" tabindex="-1"></a>    logLikeFemale,</span>
<span id="cb135-70"><a href="#cb135-70" aria-hidden="true" tabindex="-1"></a>    logLikeCC10,</span>
<span id="cb135-71"><a href="#cb135-71" aria-hidden="true" tabindex="-1"></a>    logLikePerf,</span>
<span id="cb135-72"><a href="#cb135-72" aria-hidden="true" tabindex="-1"></a>    logLikeUse</span>
<span id="cb135-73"><a href="#cb135-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-74"><a href="#cb135-74" aria-hidden="true" tabindex="-1"></a>  loglik <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">rowSums</span>(logLikeMatrix))</span>
<span id="cb135-75"><a href="#cb135-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-76"><a href="#cb135-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print iteration number and log-likelihood</span></span>
<span id="cb135-77"><a href="#cb135-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Iteration: "</span>, iteration, <span class="st">"Loglikelihood: "</span>, loglik, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb135-78"><a href="#cb135-78" aria-hidden="true" tabindex="-1"></a>  iteration <span class="ot">=</span> iteration <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb135-79"><a href="#cb135-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration:  1 Loglikelihood:  -4261.033 
Iteration:  2 Loglikelihood:  -7431.362 
Iteration:  3 Loglikelihood:  -4041.548 
Iteration:  4 Loglikelihood:  -3955.812 
Iteration:  5 Loglikelihood:  -3942.861 
Iteration:  6 Loglikelihood:  -3939.976 
Iteration:  7 Loglikelihood:  -3939.23 
Iteration:  8 Loglikelihood:  -3939.026 
Iteration:  9 Loglikelihood:  -3938.97 </code></pre>
</div>
</div>
</section>
<section id="summarizing-the-final-models" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-final-models">Summarizing the Final Models</h3>
<p>After running the EM algorithm, we summarize the estimated models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(femaleModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = female ~ 1, family = binomial(link = "logit"), 
    data = algorithmData)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.7407     0.1143   6.479 9.24e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 440.3  on 349  degrees of freedom
Residual deviance: 440.3  on 349  degrees of freedom
AIC: 442.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cc10Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cc10 ~ female, data = algorithmData)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.5496  -2.9193   0.0002   2.5035  18.6038 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.4602     0.5201  -0.885    0.377
female        0.1682     0.6320   0.266    0.790

Residual standard error: 5.528 on 348 degrees of freedom
Multiple R-squared:  0.0002035, Adjusted R-squared:  -0.002669 
F-statistic: 0.07083 on 1 and 348 DF,  p-value: 0.7903</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perfModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = perf ~ cc10 + female, data = algorithmData)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.3056 -1.2325 -0.0002  1.2760  7.7529 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 14.77696    0.22849  64.673  &lt; 2e-16 ***
cc10         0.08478    0.02352   3.604 0.000359 ***
female      -1.35005    0.27738  -4.867 1.72e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.426 on 347 degrees of freedom
Multiple R-squared:  0.09443,   Adjusted R-squared:  0.08921 
F-statistic: 18.09 on 2 and 347 DF,  p-value: 3.356e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(useModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = use ~ perf + cc10 + female, data = algorithmData)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.437  -7.195   0.000   8.537  50.326 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 32.56814    4.94663   6.584 1.70e-10 ***
perf         1.31400    0.32168   4.085 5.48e-05 ***
cc10        -0.13905    0.14358  -0.968    0.333    
female       0.01475    1.71790   0.009    0.993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.54 on 346 degrees of freedom
Multiple R-squared:  0.04906,   Adjusted R-squared:  0.04082 
F-statistic:  5.95 on 3 and 346 DF,  p-value: 0.0005763</code></pre>
</div>
</div>
</section>
</section>
<section id="adding-interactions-using-the-just-another-variable-approach" class="level2">
<h2 class="anchored" data-anchor-id="adding-interactions-using-the-just-another-variable-approach">Adding Interactions Using the Just-Another-Variable Approach</h2>
<p>In this section, we introduce an interaction term between <code>female</code> and <code>cc10</code> within the SEM framework. The interaction is treated as a separate variable, allowing <code>lavaan</code> to estimate its mean, variance, and covariances.</p>
<section id="creating-the-interaction-variable" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-interaction-variable">Creating the Interaction Variable</h3>
<p>We first compute the interaction term as the product of <code>female</code> and <code>cc10</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>data03<span class="sc">$</span>femXcc10 <span class="ot">=</span> data03<span class="sc">$</span>female <span class="sc">*</span> data03<span class="sc">$</span>cc10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="specifying-the-model-syntax-3" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-model-syntax-3">Specifying the Model Syntax</h3>
<p>This model includes <code>femXcc10</code> as an exogenous variable, alongside <code>cc10</code> and <code>female</code>. The model estimates means, variances, and covariances for these variables, as well as their effects on <code>perf</code> and <code>use</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>model05.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Exogenous Variables </span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="st">#Mean:</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~ 1</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="st">female ~ 1</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="st">femXcc10 ~ 1</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="st">#Variances:</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ cc10</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="st">female ~~ female</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="st">femXcc10 ~~ femXcc10</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="st">#Covariances:</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ female</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ femXcc10</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="st">female ~~ femXcc10</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a><span class="st"># Endogenous Variables </span></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a><span class="st">#Regressions:</span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + female + cc10 + femXcc10</span></span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1 + female + cc10 + femXcc10</span></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Variances:</span></span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Covariance:</span></span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-the-model-3" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-model-3">Estimating the Model</h3>
<p>We fit the model using <code>lavaan</code>, incorporating the interaction term as an exogenous predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>model05.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model05.syntax, <span class="at">data=</span>data03, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some observed variances are (at least) a factor 1000 times larger than 
   others; use varTable(fit) to investigate</code></pre>
</div>
</div>
</section>
<section id="summarizing-the-model-results-3" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-model-results-3">Summarizing the Model Results</h3>
<p>We extract and examine the model summary, including standardized estimates and fit measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model05.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 94 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20

  Number of observations                           350
  Number of missing patterns                        15

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                               221.450     194.386
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.139

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3430.447   -3430.447
  Loglikelihood unrestricted model (H1)      -3430.447   -3430.447
                                                                  
  Akaike (AIC)                                6900.893    6900.893
  Bayesian (BIC)                              6978.052    6978.052
  Sample-size adjusted Bayesian (SABIC)       6914.605    6914.605

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    female           -1.398    0.344   -4.065    0.000   -1.398   -0.234
    cc10              0.061    0.052    1.178    0.239    0.061    0.142
    femXcc10          0.053    0.066    0.805    0.421    0.053    0.092
  use ~                                                                 
    female           -1.856    2.201   -0.843    0.399   -1.856   -0.054
    cc10             -0.105    0.254   -0.412    0.680   -0.105   -0.042
    femXcc10          0.167    0.331    0.505    0.613    0.167    0.050

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  female ~~                                                             
    cc10              0.103    0.209    0.494    0.621    0.103    0.033
  cc10 ~~                                                               
    femXcc10         24.567    3.020    8.134    0.000   24.567    0.749
  female ~~                                                             
    femXcc10         -0.005    0.124   -0.043    0.966   -0.005   -0.002
 .perf ~~                                                               
   .use               9.298    2.784    3.340    0.001    9.298    0.207

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             -0.208    0.424   -0.490    0.624   -0.208   -0.031
    female            0.643    0.027   23.966    0.000    0.643    1.344
    femXcc10         -0.016    0.348   -0.046    0.963   -0.016   -0.003
   .perf             14.737    0.258   57.048    0.000   14.737    5.157
   .use              51.972    1.750   29.696    0.000   51.972    3.131

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             43.503    3.837   11.337    0.000   43.503    1.000
    female            0.229    0.008   29.729    0.000    0.229    1.000
    femXcc10         24.733    3.032    8.157    0.000   24.733    1.000
   .perf              7.345    0.644   11.411    0.000    7.345    0.899
   .use             274.374   24.620   11.144    0.000  274.374    0.996</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-implied-mean-vector-and-covariance-matrix-3" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-implied-mean-vector-and-covariance-matrix-3">Inspecting Model-Implied Mean Vector and Covariance Matrix</h3>
<p>We check the expected mean vector and covariance matrix under the estimated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model05.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
            perf     use  female    cc10  fmXc10
perf       8.168                                
use        9.953 275.516                        
female    -0.314  -0.437   0.229                
cc10       3.824  -0.637   0.103  43.503        
femXcc10   2.822   1.576  -0.005  24.567  24.733

$mean
    perf      use   female     cc10 femXcc10 
  13.825   50.797    0.643   -0.208   -0.016 </code></pre>
</div>
</div>
</section>
<section id="examining-the-saturated-model-statistics-3" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-saturated-model-statistics-3">Examining the Saturated Model Statistics</h3>
<p>We inspect the sample statistics from the fully saturated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model05.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
            perf     use  female    cc10  fmXc10
perf       8.168                                
use        9.953 275.516                        
female    -0.314  -0.437   0.229                
cc10       3.824  -0.637   0.103  43.503        
femXcc10   2.822   1.576  -0.005  24.567  24.733

$mean
    perf      use   female     cc10 femXcc10 
  13.825   50.797    0.643   -0.208   -0.016 </code></pre>
</div>
</div>
</section>
<section id="assessing-residuals-3" class="level3">
<h3 class="anchored" data-anchor-id="assessing-residuals-3">Assessing Residuals</h3>
<p>We evaluate the raw residuals to assess model fit discrepancies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model05.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
         perf use female cc10 fmXc10
perf        0                       
use         0   0                   
female      0   0      0            
cc10        0   0      0    0       
femXcc10    0   0      0    0      0

$mean
    perf      use   female     cc10 femXcc10 
       0        0        0        0        0 </code></pre>
</div>
</div>
<p>We also check the normalized residuals for further model diagnostics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model05.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
         perf use female cc10 fmXc10
perf        0                       
use         0   0                   
female      0   0      0            
cc10        0   0      0    0       
femXcc10    0   0      0    0      0

$mean
    perf      use   female     cc10 femXcc10 
       0        0        0        0        0 </code></pre>
</div>
</div>
</section>
<section id="checking-modification-indices-3" class="level3">
<h3 class="anchored" data-anchor-id="checking-modification-indices-3">Checking Modification Indices</h3>
<p>The <code>modindices()</code> function suggests potential model improvements by identifying additional parameters to estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(model05.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] lhs      op       rhs      mi       epc      sepc.lv  sepc.all sepc.nox
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</section>
<section id="calculating-r-squared-values-for-dependent-variables-3" class="level3">
<h3 class="anchored" data-anchor-id="calculating-r-squared-values-for-dependent-variables-3">Calculating R-Squared Values for Dependent Variables</h3>
<p>We compute the proportion of variance explained for the dependent variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model05.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> perf   use 
0.101 0.004 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-4" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model-4">Visualizing the Model</h3>
<p>We generate path diagrams to illustrate the estimated relationships.</p>
<section id="path-diagram-without-estimates-3" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-without-estimates-3">Path Diagram Without Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model05.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="path-diagram-with-estimates-3" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-with-estimates-3">Path Diagram With Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model05.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="factored-regression-with-interaction-terms-using-the-em-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="factored-regression-with-interaction-terms-using-the-em-algorithm">Factored Regression with Interaction Terms Using the EM Algorithm</h2>
<p>In this section, we use factored regression and the Expectation-Maximization (EM) algorithm to estimate missing values while incorporating an interaction term (<code>femXcc10</code>). The model follows:</p>
<p>[ f(use, perf, cc10, female, femXcc10) = f(use|perf, cc10, female, femXcc10) * f(perf|cc10, female, femXcc10) * f(cc10|female) * f(female) ]</p>
<section id="initializing-model-parameters-1" class="level3">
<h3 class="anchored" data-anchor-id="initializing-model-parameters-1">Initializing Model Parameters</h3>
<p>We set initial values for the regression coefficients in the factored regression framework.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f(female):</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>female_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># f(cc10|female) </span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>cc10_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>cc10_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co"># f(perf|cc10, female):</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>perf_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>perf_cc10 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>perf_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>perf_femXcc10 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co"># f(use|perf, cc10, female, femXcc10):</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>use_intercept <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>use_perf <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>use_cc10 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>use_female <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>use_femXcc10 <span class="ot">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identifying-missing-data-1" class="level3">
<h3 class="anchored" data-anchor-id="identifying-missing-data-1">Identifying Missing Data</h3>
<p>We determine which observations have missing values in each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>femaleMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>female))</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>cc10Missing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>cc10))</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>perfMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>perf))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>useMissing <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">is.na</span>(data03<span class="sc">$</span>use))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-the-em-algorithm-1" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-em-algorithm-1">Setting Up the EM Algorithm</h3>
<p>We create a working copy of the dataset and set the number of iterations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>algorithmData <span class="ot">=</span> data03</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>maxIterations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>iteration <span class="ot">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="em-algorithm-expectation-and-maximization-steps-1" class="level3">
<h3 class="anchored" data-anchor-id="em-algorithm-expectation-and-maximization-steps-1">EM Algorithm: Expectation and Maximization Steps</h3>
<p>We iterate through the EM process, imputing missing data in the E-step and re-estimating parameters in the M-step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(iteration <span class="sc">&lt;</span> maxIterations){</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># E-step: Impute missing values</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>female[femaleMissing] <span class="ot">=</span> </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">exp</span>(female_intercept)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(female_intercept)), <span class="dv">0</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>cc10[cc10Missing] <span class="ot">=</span> </span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    cc10_intercept <span class="sc">+</span> </span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>    cc10_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[cc10Missing]</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>perf[perfMissing] <span class="ot">=</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    perf_intercept <span class="sc">+</span> </span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>    perf_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[perfMissing] <span class="sc">+</span> </span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>    perf_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[perfMissing] <span class="sc">+</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>    perf_femXcc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[perfMissing]<span class="sc">*</span>algorithmData<span class="sc">$</span>female[perfMissing]</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>  algorithmData<span class="sc">$</span>use[useMissing] <span class="ot">=</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>    use_intercept <span class="sc">+</span> </span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>    use_perf<span class="sc">*</span>algorithmData<span class="sc">$</span>perf[useMissing] <span class="sc">+</span> </span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>    use_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[useMissing] <span class="sc">+</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>    use_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female[useMissing] <span class="sc">+</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>    use_femXcc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10[useMissing]<span class="sc">*</span>algorithmData<span class="sc">$</span>female[useMissing]</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M-step: Update regression coefficients</span></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>  femaleModel <span class="ot">=</span> <span class="fu">glm</span>(female <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> algorithmData, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>  female_intercept <span class="ot">=</span> femaleModel<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>  cc10Model <span class="ot">=</span> <span class="fu">lm</span>(cc10 <span class="sc">~</span> female, <span class="at">data =</span> algorithmData)</span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>  cc10_intercept <span class="ot">=</span> cc10Model<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>  cc10_female <span class="ot">=</span> cc10Model<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a>  perfModel <span class="ot">=</span> <span class="fu">lm</span>(perf <span class="sc">~</span> cc10 <span class="sc">+</span> female <span class="sc">+</span> cc10<span class="sc">:</span>female, <span class="at">data =</span> algorithmData)</span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>  perf_intercept <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a>  perf_cc10 <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"cc10"</span>]</span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a>  perf_female <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a>  perf_femXcc10 <span class="ot">=</span> perfModel<span class="sc">$</span>coefficients[<span class="st">"cc10:female"</span>]</span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a>  useModel <span class="ot">=</span> <span class="fu">lm</span>(use <span class="sc">~</span> perf <span class="sc">+</span> cc10 <span class="sc">+</span> female <span class="sc">+</span> cc10<span class="sc">:</span>female, <span class="at">data =</span> algorithmData)</span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a>  use_intercept <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a>  use_perf <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"perf"</span>]</span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a>  use_cc10 <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"cc10"</span>]</span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a>  use_female <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"female"</span>]</span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a>  use_femXcc10 <span class="ot">=</span> useModel<span class="sc">$</span>coefficients[<span class="st">"cc10:female"</span>]</span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute total log-likelihood</span></span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a>  loglik <span class="ot">=</span> <span class="fu">sum</span>(</span>
<span id="cb168-46"><a href="#cb168-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbinom</span>(algorithmData<span class="sc">$</span>female, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">exp</span>(female_intercept)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(female_intercept)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb168-47"><a href="#cb168-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(algorithmData<span class="sc">$</span>cc10, <span class="at">mean =</span> cc10_intercept <span class="sc">+</span> cc10_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(algorithmData<span class="sc">$</span>cc10)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb168-48"><a href="#cb168-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(algorithmData<span class="sc">$</span>perf, <span class="at">mean =</span> perf_intercept <span class="sc">+</span> perf_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10 <span class="sc">+</span> perf_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female <span class="sc">+</span> perf_femXcc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>female, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(algorithmData<span class="sc">$</span>perf)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb168-49"><a href="#cb168-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(algorithmData<span class="sc">$</span>use, <span class="at">mean =</span> use_intercept <span class="sc">+</span> use_perf<span class="sc">*</span>algorithmData<span class="sc">$</span>perf <span class="sc">+</span> use_cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10 <span class="sc">+</span> use_female<span class="sc">*</span>algorithmData<span class="sc">$</span>female <span class="sc">+</span> use_femXcc10<span class="sc">*</span>algorithmData<span class="sc">$</span>cc10<span class="sc">*</span>algorithmData<span class="sc">$</span>female, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(algorithmData<span class="sc">$</span>use)), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-50"><a href="#cb168-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb168-51"><a href="#cb168-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-52"><a href="#cb168-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print iteration number and log-likelihood</span></span>
<span id="cb168-53"><a href="#cb168-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Iteration: "</span>, iteration, <span class="st">"Loglikelihood: "</span>, loglik, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb168-54"><a href="#cb168-54" aria-hidden="true" tabindex="-1"></a>  iteration <span class="ot">=</span> iteration <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb168-55"><a href="#cb168-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration:  1 Loglikelihood:  -4064.091 
Iteration:  2 Loglikelihood:  -3621.814 
Iteration:  3 Loglikelihood:  -3556.724 
Iteration:  4 Loglikelihood:  -3552.105 
Iteration:  5 Loglikelihood:  -3551.822 
Iteration:  6 Loglikelihood:  -3551.806 
Iteration:  7 Loglikelihood:  -3551.806 
Iteration:  8 Loglikelihood:  -3551.806 
Iteration:  9 Loglikelihood:  -3551.806 </code></pre>
</div>
</div>
</section>
<section id="summarizing-the-final-models-1" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-final-models-1">Summarizing the Final Models</h3>
<p>After running the EM algorithm, we summarize the estimated models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(femaleModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = female ~ 1, family = binomial(link = "logit"), 
    data = algorithmData)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.7407     0.1143   6.479 9.24e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 440.3  on 349  degrees of freedom
Residual deviance: 440.3  on 349  degrees of freedom
AIC: 442.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cc10Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cc10 ~ female, data = algorithmData)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.5496  -2.9193   0.0002   2.5035  18.6038 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.4602     0.5201  -0.885    0.377
female        0.1682     0.6320   0.266    0.790

Residual standard error: 5.528 on 348 degrees of freedom
Multiple R-squared:  0.0002035, Adjusted R-squared:  -0.002669 
F-statistic: 0.07083 on 1 and 348 DF,  p-value: 0.7903</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perfModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = perf ~ cc10 + female + cc10:female, data = algorithmData)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.7097 -1.1405 -0.0001  1.2670  7.7489 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 14.76087    0.22900  64.459  &lt; 2e-16 ***
cc10         0.06264    0.03695   1.695   0.0909 .  
female      -1.32452    0.27818  -4.761 2.83e-06 ***
cc10:female  0.04068    0.04794   0.849   0.3967    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.428 on 346 degrees of freedom
Multiple R-squared:  0.09696,   Adjusted R-squared:  0.08913 
F-statistic: 12.38 on 3 and 346 DF,  p-value: 1.034e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(useModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = use ~ perf + cc10 + female + cc10:female, data = algorithmData)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.797  -7.371   0.000   8.547  50.678 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 32.56669    4.95164   6.577 1.78e-10 ***
perf         1.31101    0.32231   4.068 5.89e-05 ***
cc10        -0.22998    0.22245  -1.034    0.302    
female       0.07482    1.72153   0.043    0.965    
cc10:female  0.15229    0.28769   0.529    0.597    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.55 on 345 degrees of freedom
Multiple R-squared:  0.05009,   Adjusted R-squared:  0.03908 
F-statistic: 4.548 on 4 and 345 DF,  p-value: 0.001363</code></pre>
</div>
</div>
</section>
</section>
<section id="incorporating-auxiliary-variables-in-the-sem-framework" class="level2">
<h2 class="anchored" data-anchor-id="incorporating-auxiliary-variables-in-the-sem-framework">Incorporating Auxiliary Variables in the SEM Framework</h2>
<p>In this section, we extend our SEM model by including auxiliary variables (<code>hsl</code>, <code>msc</code>, <code>mas</code>, <code>mse</code>). These variables help improve estimation by capturing additional variance and reducing bias due to missing data.</p>
<section id="specifying-the-model-syntax-4" class="level3">
<h3 class="anchored" data-anchor-id="specifying-the-model-syntax-4">Specifying the Model Syntax</h3>
<p>We define a model that includes the auxiliary variables and estimates their means, variances, and covariances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>model06.syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Exogenous Variables (now with auxiliary variables)</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="st">#Means:</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~ 1</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="st">female ~ 1</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Auxiliary variables</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="st">hsl ~ 1</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="st">msc ~ 1</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="st">mas ~ 1</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="st">mse ~ 1</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="st">#Variances:</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ cc10</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="st">female ~~ female</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a><span class="st"># Auxiliary variables:</span></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a><span class="st">hsl ~~ hsl</span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="st">msc ~~ msc</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a><span class="st">mas ~~ mas</span></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a><span class="st">mse ~~ mse</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a><span class="st">#Covariances:</span></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a><span class="st">cc10 ~~ female + hsl + msc + mas + mse</span></span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a><span class="st">female ~~ hsl + msc + mas + mse</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a><span class="st">hsl ~~ msc + mas + mse</span></span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a><span class="st">msc ~~ mas + mse</span></span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a><span class="st">mas ~~ mse</span></span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a><span class="st"># Endogenous Variables </span></span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a><span class="st">#Regressions:</span></span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~ 1 + female + cc10</span></span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~ 1 + female + cc10</span></span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-36"><a href="#cb178-36" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Variances:</span></span>
<span id="cb178-37"><a href="#cb178-37" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ perf</span></span>
<span id="cb178-38"><a href="#cb178-38" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ use</span></span>
<span id="cb178-39"><a href="#cb178-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-40"><a href="#cb178-40" aria-hidden="true" tabindex="-1"></a><span class="st">#Residual Covariance:</span></span>
<span id="cb178-41"><a href="#cb178-41" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ use</span></span>
<span id="cb178-42"><a href="#cb178-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-43"><a href="#cb178-43" aria-hidden="true" tabindex="-1"></a><span class="st">#Endogenous/exogenous covariances</span></span>
<span id="cb178-44"><a href="#cb178-44" aria-hidden="true" tabindex="-1"></a><span class="st">perf ~~ hsl + msc + mas + mse</span></span>
<span id="cb178-45"><a href="#cb178-45" aria-hidden="true" tabindex="-1"></a><span class="st">use  ~~ hsl + msc + mas + mse</span></span>
<span id="cb178-46"><a href="#cb178-46" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-the-model-4" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-model-4">Estimating the Model</h3>
<p>We fit the model using <code>lavaan</code>, incorporating auxiliary variables into the SEM framework.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>model06.fit <span class="ot">=</span> <span class="fu">lavaan</span>(model06.syntax, <span class="at">data=</span>data03, <span class="at">estimator =</span> <span class="st">"MLR"</span>, <span class="at">mimic =</span> <span class="st">"MPLUS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some observed variances are (at least) a factor 1000 times larger than 
   others; use varTable(fit) to investigate</code></pre>
</div>
</div>
</section>
<section id="summarizing-the-model-results-4" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-the-model-results-4">Summarizing the Model Results</h3>
<p>We extract and examine the model summary, including standardized estimates and fit measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model06.fit, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 320 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        44

  Number of observations                           350
  Number of missing patterns                        15

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 0.000       0.000
  Degrees of freedom                                 0           0

Model Test Baseline Model:

  Test statistic                              1200.876    1186.405
  Degrees of freedom                                28          28
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.012

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       1.000
  Tucker-Lewis Index (TLI)                       1.000       1.000
                                                                  
  Robust Comparative Fit Index (CFI)                         1.000
  Robust Tucker-Lewis Index (TLI)                            1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6976.618   -6976.618
  Loglikelihood unrestricted model (H1)      -6976.618   -6976.618
                                                                  
  Akaike (AIC)                               14041.235   14041.235
  Bayesian (BIC)                             14210.984   14210.984
  Sample-size adjusted Bayesian (SABIC)      14071.400   14071.400

Root Mean Square Error of Approximation:

  RMSEA                                          0.000          NA
  90 Percent confidence interval - lower         0.000          NA
  90 Percent confidence interval - upper         0.000          NA
  P-value H_0: RMSEA &lt;= 0.050                       NA          NA
  P-value H_0: RMSEA &gt;= 0.080                       NA          NA
                                                                  
  Robust RMSEA                                               0.000
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                            NA
  P-value H_0: Robust RMSEA &gt;= 0.080                            NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000       0.000

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perf ~                                                                
    female           -1.348    0.323   -4.177    0.000   -1.348   -0.230
    cc10              0.077    0.031    2.472    0.013    0.077    0.181
  use ~                                                                 
    female           -1.631    2.130   -0.766    0.444   -1.631   -0.047
    cc10              0.090    0.154    0.588    0.557    0.090    0.036

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  female ~~                                                             
    cc10              0.110    0.207    0.533    0.594    0.110    0.035
  cc10 ~~                                                               
    hsl               1.667    0.475    3.506    0.000    1.667    0.217
    msc              18.586    6.893    2.696    0.007   18.586    0.167
    mas              10.186    4.452    2.288    0.022   10.186    0.139
    mse              16.436    4.361    3.769    0.000   16.436    0.225
  female ~~                                                             
    hsl              -0.023    0.031   -0.758    0.448   -0.023   -0.042
    msc              -1.470    0.444   -3.313    0.001   -1.470   -0.182
    mas              -1.319    0.296   -4.461    0.000   -1.319   -0.247
    mse              -1.471    0.289   -5.094    0.000   -1.471   -0.278
  hsl ~~                                                                
    msc               9.654    1.226    7.874    0.000    9.654    0.488
    mas               5.586    0.783    7.134    0.000    5.586    0.429
    mse               6.455    0.773    8.353    0.000    6.455    0.499
  msc ~~                                                                
    mas             163.789   13.358   12.262    0.000  163.789    0.867
    mse             120.603   11.970   10.075    0.000  120.603    0.643
  mas ~~                                                                
    mse              77.324    8.012    9.651    0.000   77.324    0.625
 .perf ~~                                                               
   .use              10.321    2.658    3.883    0.000   10.321    0.230
    hsl               1.231    0.203    6.067    0.000    1.231    0.393
    msc              23.991    2.990    8.025    0.000   23.991    0.528
    mas              15.561    1.912    8.139    0.000   15.561    0.519
    mse              19.275    1.775   10.857    0.000   19.275    0.648
 .use ~~                                                                
    hsl               3.185    1.144    2.785    0.005    3.185    0.163
    msc             150.109   18.284    8.210    0.000  150.109    0.531
    mas              78.455   11.116    7.058    0.000   78.455    0.421
    mse              61.943   10.620    5.833    0.000   61.943    0.335

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             -0.171    0.420   -0.408    0.683   -0.171   -0.026
    female            0.643    0.027   24.042    0.000    0.643    1.344
    hsl               4.882    0.062   78.246    0.000    4.882    4.182
    msc              49.951    0.905   55.199    0.000   49.951    2.951
    mas              31.902    0.596   53.489    0.000   31.902    2.859
    mse              73.414    0.592  123.941    0.000   73.414    6.625
   .perf             14.786    0.246   60.019    0.000   14.786    5.273
   .use              52.513    1.693   31.019    0.000   52.513    3.138

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    cc10             43.432    3.835   11.326    0.000   43.432    1.000
    female            0.229    0.008   29.677    0.000    0.229    1.000
    hsl               1.363    0.097   14.031    0.000    1.363    1.000
    msc             286.613   21.544   13.304    0.000  286.613    1.000
    mas             124.504    9.653   12.898    0.000  124.504    1.000
    mse             122.801    8.763   14.013    0.000  122.801    1.000
   .perf              7.210    0.595   12.128    0.000    7.210    0.917
   .use             279.096   24.901   11.208    0.000  279.096    0.997</code></pre>
</div>
</div>
</section>
<section id="inspecting-model-implied-mean-vector-and-covariance-matrix-4" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model-implied-mean-vector-and-covariance-matrix-4">Inspecting Model-Implied Mean Vector and Covariance Matrix</h3>
<p>We check the expected mean vector and covariance matrix under the estimated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model06.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10     hsl     msc     mas     mse
perf     7.862                                                        
use     11.099 280.027                                                
female  -0.300  -0.363   0.229                                        
cc10     3.202   3.742   0.110  43.432                                
hsl      1.392   3.374  -0.023   1.667   1.363                        
msc     27.407 154.185  -1.470  18.586   9.654 286.613                
mas     18.125  81.527  -1.319  10.186   5.586 163.789 124.504        
mse     22.526  65.827  -1.471  16.436   6.455 120.603  77.324 122.801

$mean
  perf    use female   cc10    hsl    msc    mas    mse 
13.906 51.449  0.643 -0.171  4.882 49.951 31.902 73.414 </code></pre>
</div>
</div>
</section>
<section id="examining-the-saturated-model-statistics-4" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-saturated-model-statistics-4">Examining the Saturated Model Statistics</h3>
<p>We inspect the sample statistics from the fully saturated model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model06.fit, <span class="at">what=</span><span class="st">"sampstat.h1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
          perf     use  female    cc10     hsl     msc     mas     mse
perf     7.862                                                        
use     11.099 280.027                                                
female  -0.300  -0.363   0.229                                        
cc10     3.202   3.742   0.110  43.432                                
hsl      1.392   3.374  -0.023   1.667   1.363                        
msc     27.407 154.185  -1.470  18.586   9.654 286.613                
mas     18.125  81.527  -1.319  10.186   5.586 163.789 124.504        
mse     22.526  65.827  -1.471  16.436   6.455 120.603  77.324 122.801

$mean
  perf    use female   cc10    hsl    msc    mas    mse 
13.906 51.449  0.643 -0.171  4.882 49.951 31.902 73.414 </code></pre>
</div>
</div>
</section>
<section id="assessing-residuals-4" class="level3">
<h3 class="anchored" data-anchor-id="assessing-residuals-4">Assessing Residuals</h3>
<p>We evaluate the raw residuals to assess model fit discrepancies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model06.fit, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       perf use female cc10 hsl msc mas mse
perf      0                                
use       0   0                            
female    0   0      0                     
cc10      0   0      0    0                
hsl       0   0      0    0   0            
msc       0   0      0    0   0   0        
mas       0   0      0    0   0   0   0    
mse       0   0      0    0   0   0   0   0

$mean
  perf    use female   cc10    hsl    msc    mas    mse 
     0      0      0      0      0      0      0      0 </code></pre>
</div>
</div>
<p>We also check the normalized residuals for further model diagnostics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model06.fit, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       perf use female cc10 hsl msc mas mse
perf      0                                
use       0   0                            
female    0   0      0                     
cc10      0   0      0    0                
hsl       0   0      0    0   0            
msc       0   0      0    0   0   0        
mas       0   0      0    0   0   0   0    
mse       0   0      0    0   0   0   0   0

$mean
  perf    use female   cc10    hsl    msc    mas    mse 
     0      0      0      0      0      0      0      0 </code></pre>
</div>
</div>
</section>
<section id="checking-modification-indices-4" class="level3">
<h3 class="anchored" data-anchor-id="checking-modification-indices-4">Checking Modification Indices</h3>
<p>The <code>modindices()</code> function suggests potential model improvements by identifying additional parameters to estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(model06.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] lhs      op       rhs      mi       epc      sepc.lv  sepc.all sepc.nox
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</section>
<section id="calculating-r-squared-values-for-dependent-variables-4" class="level3">
<h3 class="anchored" data-anchor-id="calculating-r-squared-values-for-dependent-variables-4">Calculating R-Squared Values for Dependent Variables</h3>
<p>We compute the proportion of variance explained for the dependent variables in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(model06.fit, <span class="at">what=</span><span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> perf   use 
0.083 0.003 </code></pre>
</div>
</div>
</section>
<section id="visualizing-the-model-5" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-model-5">Visualizing the Model</h3>
<p>We generate path diagrams to illustrate the estimated relationships.</p>
<section id="path-diagram-without-estimates-4" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-without-estimates-4">Path Diagram Without Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model06.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">what =</span><span class="st">"path"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="path-diagram-with-estimates-4" class="level4">
<h4 class="anchored" data-anchor-id="path-diagram-with-estimates-4">Path Diagram With Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model06.fit, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">style=</span><span class="st">"mx"</span>, <span class="at">layout=</span><span class="st">"tree"</span>, <span class="at">rotation=</span><span class="dv">2</span>,</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">optimizeLatRes =</span> <span class="cn">TRUE</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">whatLabels =</span><span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05_MLE_with_Missing_Data_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="analysis-strategy-decision-strategy" class="level2">
<h2 class="anchored" data-anchor-id="analysis-strategy-decision-strategy">Analysis Strategy Decision Strategy</h2>
<p>This text-based flowchart outlines the decision-making process for handling missing data in analysis.</p>
<ol type="1">
<li><strong>Have missing data?</strong>
<ul>
<li><strong>No</strong>  Conduct analysis as usual.<br>
</li>
<li><strong>Yes</strong>  Proceed to the next step.
<ul>
<li><strong>Minimum goal:</strong> Build an analysis that meets the assumptions of Missing at Random (MAR). For Maximum Likelihood Estimation, use likelihoods to your benefit.</li>
</ul></li>
</ul></li>
<li><strong>Are all variables with missing data (in your model and auxiliary variables) plausibly continuous (so that you can assume they follow multivariate normal distributions)?</strong>
<ul>
<li><strong>Yes</strong>  Use <strong>SEM framework (lavaan)</strong> where all variables (including auxiliary variables) are in the likelihood function.<br>
</li>
<li><strong>No</strong>  Use <strong>factored regression approach</strong> (likely not EM algorithm unless you are savvy at coding), as implemented in <strong>Bayesian methods (next lecture)</strong>. Or use <strong>Multiple Imputation methods</strong> that treat non-normal data appropriately.</li>
</ul></li>
</ol>
<p>This structured approach ensures a systematic decision-making process for handling missing data in analysis.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>