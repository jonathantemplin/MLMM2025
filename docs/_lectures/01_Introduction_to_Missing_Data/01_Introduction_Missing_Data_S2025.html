<!DOCTYPE html>
<html lang="en"><head>
<script src="01_Introduction_Missing_Data_S2025_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/tabby.min.js"></script>
<script src="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/popper.min.js"></script>
<script src="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="01_Introduction_Missing_Data_S2025_files/libs/quarto-html/quarto-syntax-highlighting-f23ab18612d661d7bd56dbc0c0fd3817.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.34">

  <meta name="author" content="Lecture 1: January 29, 2025">
  <title>Introduction to Missing Data Methods Class</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/dist/theme/quarto-16232f29d62c098d89a38a65e10d436d.css">
  <link href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Introduction to Missing Data Methods Class</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Lecture 1: January 29, 2025 
</div>
</div>
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives</h2>
<ol type="1">
<li>Understand the challenges and implications of missing data in research</li>
<li>Classify missing data by patterns and mechanisms using Rubin’s framework</li>
<li>Recognize the limitations of outdated missing data methods</li>
<li>Explore the design and application of planned missing data methods</li>
</ol>
</section>
<section>
<section id="importance-of-missing-data" class="title-slide slide level1 center">
<h1>Importance of Missing Data</h1>

</section>
<section id="why-missing-data-matters" class="slide level2">
<h2>Why Missing Data Matters</h2>
<ul>
<li>Missing data is pervasive across disciplines (e.g., education, psychology, medicine, political science)</li>
<li>One big example: Polling errors in elections in 2016/2020 seemed to be affected by missing data (MNAR) - Remedies have been subjective at best</li>
<li>Mishandling missing data can:
<ul>
<li>Bias results –&gt; Inaccurate conclusions</li>
<li>Reduce statistical power</li>
</ul></li>
</ul>
</section>
<section id="modern-methods" class="slide level2">
<h2>Modern Methods</h2>
<ul>
<li><strong>Maximum Likelihood (ML):</strong> Estimates parameters directly from observed data likelihood</li>
<li><strong>Bayesian Estimation:</strong> Combines prior beliefs with data likelihood</li>
<li><strong>Multiple Imputation (MI):</strong> Reflects uncertainty by filling in missing data with plausible values</li>
</ul>
<p>Additional note: Methods here typically require full-information analyses (i.e., likelihoods based on the data directly)</p>
</section>
<section id="missing-data-patterns-vs.-mechanisms" class="slide level2">
<h2>Missing Data Patterns vs.&nbsp;Mechanisms</h2>
<ul>
<li>A missing data pattern refers to the configuration of observed and missing values in a data set
<ul>
<li>What you observe in data</li>
</ul></li>
<li>A missing data mechanism refers to processes that describe different ways in which the probability of missing values relates to the data
<ul>
<li>Typically untestable</li>
<li>What is assumed about data</li>
</ul></li>
<li>Patterns describe where the holes are in the data, whereas mech- anisms describe why the values are missing</li>
</ul>
</section></section>
<section>
<section id="missing-data-patterns" class="title-slide slide level1 center">
<h1>Missing Data Patterns</h1>

</section>
<section id="types-of-missing-data-patterns" class="slide level2">
<h2>Types of Missing Data Patterns</h2>
<div class="columns">
<div class="column">
<ul>
<li>Univariate</li>
<li>Monotone</li>
<li>General</li>
<li>Planned Missingness</li>
<li>Latent Variable</li>
<li>Underidentified</li>
</ul>
</div><div class="column">
<p><img data-src="img/missing_patterns.png" width="600"></p>
</div></div>
</section>
<section id="univariate-pattern" class="slide level2">
<h2>Univariate Pattern</h2>
<ul>
<li>Missing values restricted to one variable</li>
<li>Example: Missing outcomes for some participants</li>
</ul>
</section>
<section id="monotone-pattern" class="slide level2">
<h2>Monotone Pattern</h2>
<ul>
<li>Missing data accumulates predictably</li>
<li>Example: Dropout in longitudinal studies</li>
<li>Can be treated without complicated iterative estimation algorithms</li>
</ul>
</section>
<section id="general-pattern" class="slide level2">
<h2>General Pattern</h2>
<ul>
<li>Missing data scattered randomly across the dataset</li>
<li>The three contemporary methods (maximum likelihood, Bayesian estimation, and multiple imputation) work well with this configuration</li>
<li>Generally no reason to choose an analytic method based on the missing data pattern alone</li>
</ul>
</section>
<section id="planned-missingness" class="slide level2">
<h2>Planned Missingness</h2>
<ul>
<li>Variables are intentionally missing for a large proportion of respondents</li>
<li>Can reduce respondent burden and research costs</li>
<li>Often with minimal impact on statistical power</li>
</ul>
</section>
<section id="latent-variable-pattern" class="slide level2">
<h2>Latent Variable Pattern</h2>
<ul>
<li>Latent variables are essentially missing data
<ul>
<li>Presents challenges in secondary analyses</li>
</ul></li>
<li>Example: Iowa wishes to understand how well an incoming student’s ACT score predicts first year GPA
<ul>
<li>ACT Score: An estimate–not an observation
<ul>
<li>Can think of scores as single imputation</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="underidentified-pattern" class="slide level2">
<h2>Underidentified Pattern</h2>
<ul>
<li>Insufficient overlap of data for estimation</li>
<li>Example: Sparse cell counts for categorical variables</li>
</ul>
</section></section>
<section>
<section id="missing-data-mechanisms" class="title-slide slide level1 center">
<h1>Missing Data Mechanisms</h1>

</section>
<section id="hypothetical-data-partitioning-observed-data" class="slide level2">
<h2>Hypothetical Data Partitioning: Observed Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>Before getting to the types of missing data mechanisms, we must first define some notation</li>
<li>Our observed data matrix will be defined as <span class="math inline">\(\mathbf{Y}_{(\text{obs})}\)</span></li>
<li>Here, <span class="math inline">\(\mathbf{Y}_{(\text{obs})} = \left[Y_1, Y_2, Y_3 \right]\)</span></li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/Yobs.png" class="quarto-figure quarto-figure-center" width="200"></p>
</figure>
</div>
</div></div>
</section>
<section id="hypothetical-data-partitioning-complete-data" class="slide level2">
<h2>Hypothetical Data Partitioning: Complete Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>Imagine if you could somehow see what the values of the missing data were – the complete data</li>
<li>Our hypothetical data matrix will be defined as <span class="math inline">\(\mathbf{Y}_{(\text{com})}\)</span> (sometimes denoted <span class="math inline">\(\mathbf{Y}_{(1)}\)</span>)</li>
<li>Note: This is not possible through any method and is only a hypothetical example to help define missing data mechanisms</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/Ycom.png" class="quarto-figure quarto-figure-center" width="200"></p>
</figure>
</div>
</div></div>
</section>
<section id="hypothetical-data-partitioning-missing-data" class="slide level2">
<h2>Hypothetical Data Partitioning: Missing Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>Now, take the values that were missing and only create a matrix of those terms</li>
<li>Our hypothetical data matrix will be defined as <span class="math inline">\(\mathbf{Y}_{(\text{mis})}\)</span> (sometimes denoted <span class="math inline">\(\mathbf{Y}_{(0)}\)</span>)</li>
<li>Note: Again, this is not possible through any method and is only a hypothetical example to help define missing data mechanisms</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/Ymis.png" class="quarto-figure quarto-figure-center" width="200"></p>
</figure>
</div>
</div></div>
</section>
<section id="rubins-framework" class="slide level2">
<h2>Rubin’s Framework</h2>
<div class="columns">
<div class="column">
<ul>
<li>Models that explain whether a participant has missing values</li>
<li>How those tendencies relate to the realized data in <span class="math inline">\(\mathbf{Y}_{(\text{obs})}\)</span> or <span class="math inline">\(\mathbf{Y}_{(\text{mis})}\)</span></li>
<li>Here, <span class="math inline">\(\mathbf{M} = \left[M_1, M_2, M_3 \right]\)</span></li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/Indicators.png" class="quarto-figure quarto-figure-center" width="200"></p>
</figure>
</div>
</div></div>
</section>
<section id="example-data" class="slide level2">
<h2>Example Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>To demonstrate some of the ideas of types of missing data, let’s consider a situation where you have collected two variables:
<ul>
<li>IQ scores</li>
<li>Job performance</li>
</ul></li>
<li>Imagine you are an employer looking to hire employees for a job where IQ is important</li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    IQ perfC
1   78     9
2   84    13
3   84    10
4   85     8
5   87     7
6   91     7
7   92     9
8   94     9
9   94    11
10  96     7
11  99     7
12 105    10
13 105    11
14 106    15
15 108    10
16 112    10
17 113    12
18 115    14
19 118    16
20 134    12</code></pre>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="missing-data-mechanisms-1" class="title-slide slide level1 center">
<h1>Missing Data Mechanisms</h1>

</section>
<section id="missing-data-mechanisms-2" class="slide level2">
<h2>Missing Data Mechanisms</h2>
<p>A very rough typology of missing data puts missing observations into three categories:</p>
<ul>
<li>Missing Completely At Random (MCAR)</li>
<li>Missing At Random (MAR)</li>
<li>Missing Not At Random (MNAR)</li>
</ul>
</section>
<section id="missing-completely-at-random-mcar" class="slide level2">
<h2>Missing Completely At Random (MCAR)</h2>
<ul>
<li>Missing data are MCAR if the events that lead to missingness are independent of:
<ul>
<li>The observed variables</li>
<li><em>-and-</em></li>
<li>The unobserved parameters of interest</li>
</ul></li>
<li>Examples:
<ul>
<li>Planned missingness in survey research
<ul>
<li>Some large-scale tests are sampled using booklets</li>
<li>Students receive only a few of the total number of items</li>
<li>The items not received are treated as missing – but that is completely a function of sampling and no other mechanism</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="a-formal-mcar-definition" class="slide level2">
<h2>A Formal MCAR Definition</h2>
<p>Formally, we note that data are MCAR if the probability of the data being missing is independent of the observed data <span class="math inline">\(\mathbf{Y}_{(obs)}\)</span> and the missing data <span class="math inline">\(\mathbf{Y}_{(mis)}\)</span>:</p>
<p><span class="math display">\[Pr \left(\mathbf{M} = 1 \mid \mathbf{Y}_{(obs)}, \mathbf{Y}_{(mis)}, \boldsymbol{\phi} \right) = Pr \left(\mathbf{M} = 1 \mid  \boldsymbol{\phi} \right)\]</span></p>
<ul>
<li>Here, <span class="math inline">\(\boldsymbol{\phi}\)</span> are model parameters that define the overall probabilities of missing data</li>
<li>Like saying a missing observation is due to pure randomness (such as missing if a coin flipped falls on heads)</li>
</ul>
</section>
<section id="implications-of-mcar" class="slide level2">
<h2>Implications of MCAR</h2>
<ul>
<li>Because the mechanism of missing is not due to anything other than chance, inclusion of MCAR in data will not bias your results
<ul>
<li>Can use methods based on listwise deletion, multiple imputation, or maximum likelihood</li>
</ul></li>
<li>Your effective sample size is lowered, though
<ul>
<li>Less power, less efficiency</li>
</ul></li>
</ul>
</section>
<section id="mcar-data" class="slide level2">
<h2>MCAR Data</h2>
<div class="columns">
<div class="column">
<p>Missing data are dispersed randomly throughout data</p>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    IQ perfMCAR
1   78       NA
2   84       13
3   84       NA
4   85        8
5   87        7
6   91        7
7   92        9
8   94        9
9   94       11
10  96       NA
11  99        7
12 105       10
13 105       11
14 106       15
15 108       10
16 112       NA
17 113       12
18 115       14
19 118       16
20 134       NA</code></pre>
</div>
</div>
</div></div>
</section>
<section id="mcar-vs.-complete-data-comparison" class="slide level2">
<h2>MCAR vs.&nbsp;Complete Data Comparison</h2>
<div class="columns">
<div class="column">
<p>Complete Data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            20

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  IQ ~~                                                                 
    perfC            19.500    9.151    2.131    0.033   19.500    0.542

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              100.000    3.079   32.478    0.000  100.000    7.262
    perfC            10.350    0.584   17.714    0.000   10.350    3.961

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              189.600   59.957    3.162    0.002  189.600    1.000
    perfC             6.828    2.159    3.162    0.002    6.828    1.000</code></pre>
</div>
</div>
</div><div class="column">
<p>MAR Data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            15

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  IQ ~~                                                                 
    perfMCAR         19.360    9.299    2.082    0.037   19.360    0.638

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ               99.733    2.777   35.916    0.000   99.733    9.274
    perfMCAR         10.600    0.729   14.539    0.000   10.600    3.754

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              115.662   42.234    2.739    0.006  115.662    1.000
    perfMCAR          7.973    2.911    2.739    0.006    7.973    1.000</code></pre>
</div>
</div>
</div></div>
</section>
<section id="missing-at-random-definition" class="slide level2">
<h2>Missing at Random Definition</h2>
<p>Formally, we note that data are MAR if the probability of the data being missing is related to the observed data <span class="math inline">\(\mathbf{Y}_{(obs)}\)</span> but not the missing data <span class="math inline">\(\mathbf{Y}_{(mis)}\)</span>:</p>
<p><span class="math display">\[Pr \left(\mathbf{M} = 1 \mid \mathbf{Y}_{(obs)}, \mathbf{Y}_{(mis)}, \boldsymbol{\phi} \right) = Pr \left(\mathbf{M} = 1 \mid  \mathbf{Y}_{(obs)}, \boldsymbol{\phi} \right)\]</span></p>
<ul>
<li>Again, <span class="math inline">\(\boldsymbol{\phi}\)</span> are model parameters that define the overall probabilities of missing data</li>
<li>Like saying a missing observation is due to pure randomness (such as missing if a coin flipped falls on heads)</li>
</ul>
</section>
<section id="mar-data" class="slide level2">
<h2>MAR Data</h2>
<div class="columns">
<div class="column">
<p>Missing data are related to other data:</p>
<ul>
<li>Any IQ less than 90 did not have a performance variable
<ul>
<li>Could be that anyone with an IQ of 90 or less was not hired</li>
<li>Not hired means not having job performance data</li>
</ul></li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    IQ perfMAR
1   78      NA
2   84      NA
3   84      NA
4   85      NA
5   87      NA
6   91       7
7   92       9
8   94       9
9   94      11
10  96       7
11  99       7
12 105      10
13 105      11
14 106      15
15 108      10
16 112      10
17 113      12
18 115      14
19 118      16
20 134      12</code></pre>
</div>
</div>
</div></div>
</section>
<section id="implications-of-mar" class="slide level2">
<h2>Implications of MAR</h2>
<ul>
<li>If data are missing at random, biased results could occur</li>
<li>Inferences based on listwise deletion will be biased and inefficient
<ul>
<li>Fewer data points = more error in analysis</li>
</ul></li>
<li>Inferences based on maximum likelihood will be unbiased but inefficient</li>
<li>The first eight chapters of the book focus on methods for MAR data</li>
</ul>
</section>
<section id="mar-vs.-complete-data-comparison" class="slide level2">
<h2>MAR vs.&nbsp;Complete Data Comparison</h2>
<div class="columns">
<div class="column">
<p>Complete Data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            20

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  IQ ~~                                                                 
    perfC            19.500    9.151    2.131    0.033   19.500    0.542

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              100.000    3.079   32.478    0.000  100.000    7.262
    perfC            10.350    0.584   17.714    0.000   10.350    3.961

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              189.600   59.957    3.162    0.002  189.600    1.000
    perfC             6.828    2.159    3.162    0.002    6.828    1.000</code></pre>
</div>
</div>
</div><div class="column">
<p>MAR Data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 21 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            15

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  IQ ~~                                                                 
    perfMAR          19.489    9.413    2.070    0.038   19.489    0.633

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              105.467    2.947   35.791    0.000  105.467    9.241
    perfMAR          10.667    0.697   15.302    0.000   10.667    3.951

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    IQ              130.249   47.560    2.739    0.006  130.249    1.000
    perfMAR           7.289    2.662    2.739    0.006    7.289    1.000</code></pre>
</div>
</div>
</div></div>
</section>
<section id="missing-not-at-random-mnar-definition" class="slide level2">
<h2>Missing Not At Random (MNAR) Definition</h2>
<p>Formally, we note that data are MNAR if the probability of the data being missing is related to the observed data <span class="math inline">\(\mathbf{Y}_{(obs)}\)</span> and the missing data <span class="math inline">\(\mathbf{Y}_{(mis)}\)</span>:</p>
<p><span class="math display">\[Pr \left(\mathbf{M} = 1 \mid \mathbf{Y}_{(obs)}, \mathbf{Y}_{(mis)}, \boldsymbol{\phi} \right)\]</span></p>
<ul>
<li>Again, <span class="math inline">\(\boldsymbol{\phi}\)</span> are model parameters that define the overall probabilities of missing data</li>
</ul>
<p>Often called non-ignorable missingness</p>
<ul>
<li>Inferences based on listwise deletion or maximum likelihood will be biased and inefficient</li>
<li>Need to provide statistical model for missing data simultaneously with estimation of original model</li>
</ul>
</section></section>
<section>
<section id="surviving-missing-data-a-brief-guide" class="title-slide slide level1 center">
<h1>Surviving Missing data: A Brief Guide</h1>

</section>
<section id="using-statistical-methods-with-missing-data" class="slide level2">
<h2>Using Statistical Methods with Missing Data</h2>
<ul>
<li>Missing data can alter your analysis results dramatically depending upon:
<ul>
<li>1. The type of missing data</li>
<li>2. The type of analysis algorithm</li>
</ul></li>
<li>The choice of an algorithm and missing data method is important in avoiding issues due to missing data</li>
</ul>
</section>
<section id="the-worst-case-scenario-mnar" class="slide level2">
<h2>The Worst Case Scenario: MNAR</h2>
<ul>
<li>The worst case scenario is when data are MNAR: missing not at random
<ul>
<li>Non-ignorable missing</li>
</ul></li>
<li>You cannot easily get out of this mess
<ul>
<li>Instead you have to be clairvoyant</li>
</ul></li>
<li>Analyses algorithms must incorporate models for missing data
<ul>
<li>And these models must also be right</li>
</ul></li>
</ul>
</section>
<section id="the-reality" class="slide level2">
<h2>The Reality</h2>
<ul>
<li>In most empirical studies, MNAR as a condition is an afterthought</li>
<li>It is impossible to know definitively if data truly are MNAR
<ul>
<li>So data are treated as MAR or MCAR</li>
</ul></li>
<li>Hypothesis tests do exist for MCAR (i.e., Little’s test)
<ul>
<li>But, often this test is rejected</li>
</ul></li>
</ul>
</section>
<section id="the-best-case-scenario-mcar" class="slide level2">
<h2>The Best Case Scenario: MCAR</h2>
<ul>
<li>Under MCAR, pretty much anything you do with your data will give you the “right” (unbiased) estimates of your model parameters</li>
<li>MCAR is very unlikely to occur
<ul>
<li>In practice, MCAR is treated as equally unlikely as MNAR</li>
</ul></li>
</ul>
</section>
<section id="the-middle-ground-mar" class="slide level2">
<h2>The Middle Ground: MAR</h2>
<ul>
<li>MAR is the common compromise used in most empirical research
<ul>
<li>Under MAR, maximum likelihood algorithms are unbiased</li>
</ul></li>
<li>Maximum likelihood is for many methods:
<ul>
<li>Linear mixed models i</li>
<li>Models with “latent” random effects (CFA/SEM models)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="outdated-methods-for-handling-missing-data" class="title-slide slide level1 center">
<h1>Outdated Methods for Handling Missing Data</h1>

</section>
<section id="bad-ways-to-handle-missing-data" class="slide level2">
<h2>Bad Ways to Handle Missing Data</h2>
<ul>
<li>Dealing with missing data is important, as the mechanisms you choose can dramatically alter your results</li>
<li>This point was not fully realized when the first methods for missing data were created
<ul>
<li>Each of the methods described in this section should <em>never be used</em></li>
<li>Given to show perspective – and to allow you to understand what happens if you were to choose each</li>
</ul></li>
</ul>
</section>
<section id="deletion-methods" class="slide level2">
<h2>Deletion Methods</h2>
<ul>
<li>Deletion methods are just that: methods that handle missing data by deleting observations
<ul>
<li>Listwise deletion: delete the entire observation if any values are missing</li>
<li>Pairwise deletion: delete a pair of observations if either of the values are missing</li>
</ul></li>
<li>Assumptions: Data are MCAR</li>
<li>Limitations:
<ul>
<li>Reduction in statistical power if MCAR</li>
<li>Biased estimates if MAR or MNAR</li>
</ul></li>
</ul>
</section>
<section id="listwise-deletion" class="slide level2">
<h2>Listwise Deletion</h2>
<ul>
<li>Listwise deletion discards <em>all</em> of the data from an observation if one or more variables are missing</li>
<li>Most frequently used in statistical software packages that are not optimizing a likelihood function (need ML)</li>
<li>In linear models:
<ul>
<li>R lm() list-wise deletes cases where <strong>DVs</strong> are missing</li>
</ul></li>
</ul>
</section>
<section id="listwise-deletion-example-mcar" class="slide level2">
<h2>Listwise Deletion Example: MCAR</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  perfC ~                                             
    IQ                0.103    0.036    2.884    0.004

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfC             0.065    3.600    0.018    0.986

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfC             4.822    1.525    3.162    0.002</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  perfMCAR ~                                          
    IQ                0.167    0.052    3.205    0.001

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfMCAR         -6.094    5.239   -1.163    0.245

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfMCAR          4.733    1.728    2.739    0.006</code></pre>
</div>
</div>
</div></div>
</section>
<section id="listwise-deletion-example-mar" class="slide level2">
<h2>Listwise Deletion Example: MAR</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  perfC ~                                             
    IQ                0.103    0.036    2.884    0.004

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfC             0.065    3.600    0.018    0.986

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfC             4.822    1.525    3.162    0.002</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  perfMAR ~                                           
    IQ                0.150    0.047    3.163    0.002

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfMAR          -5.114    5.019   -1.019    0.308

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .perfMAR           4.373    1.597    2.739    0.006</code></pre>
</div>
</div>
</div></div>
</section>
<section id="pairwise-deletion" class="slide level2">
<h2>Pairwise Deletion</h2>
<ul>
<li>Pairwise deletion discards a pair of observations if either one is missing
<ul>
<li>Different from listwise: uses more data (rest of data not thrown out)</li>
</ul></li>
<li>Assumes: MCAR</li>
<li>Limitations:
<ul>
<li>Reduction in statistical power if MCAR</li>
<li>Biased estimates if MAR or MNAR</li>
</ul></li>
<li>Can be an issue when forming covariance/correlation matrices
<ul>
<li>May make them non-invertible, problem if used as input into statistical procedures</li>
</ul></li>
</ul>
</section>
<section id="pairwise-deletion-example" class="slide level2">
<h2>Pairwise Deletion Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">cor</span>(jobPerf, <span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                IQ     perfC  perfMCAR   perfMAR
IQ       1.0000000 0.5419817 0.6375139 0.6325129
perfC    0.5419817 1.0000000 1.0000000 1.0000000
perfMCAR 0.6375139 1.0000000 1.0000000 1.0000000
perfMAR  0.6325129 1.0000000 1.0000000 1.0000000</code></pre>
</div>
</div>
</section>
<section id="single-imputation-methods" class="slide level2">
<h2>Single Imputation Methods</h2>
<ul>
<li><strong>Single imputation </strong> methods replace missing data with some type of value
<ul>
<li><em>Single:</em> one value used</li>
<li><em>Imputation:</em> replace missing data with value</li>
</ul></li>
<li>Upside: can use entire data set if missing values are replaced</li>
<li>Downside: biased parameter estimates and standard errors (even if missing is MCAR)
<ul>
<li>Type-I error issues</li>
</ul></li>
<li>Still: never use these techniques</li>
</ul>
</section>
<section id="unconditional-mean-imputation" class="slide level2">
<h2>Unconditional Mean Imputation</h2>
<ul>
<li>Unconditional mean imputation replaces the missing values of a variable with its estimated mean
<ul>
<li>Unconditional = mean value without any input from other variables</li>
</ul></li>
</ul>
</section>
<section id="unconditional-mean-imputation-mcar-data-vs-complete-data" class="slide level2">
<h2>Unconditional Mean Imputation: MCAR Data vs Complete Data</h2>
<div class="columns">
<div class="column">
<p>Complete</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = perfC ~ IQ, data = jobPerf)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2472 -1.6498 -0.6301  1.2742  4.2956 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  0.06519    3.79433   0.017   0.9865  
IQ           0.10285    0.03759   2.736   0.0136 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.315 on 18 degrees of freedom
Multiple R-squared:  0.2937,    Adjusted R-squared:  0.2545 
F-statistic: 7.487 on 1 and 18 DF,  p-value: 0.01357</code></pre>
</div>
</div>
</div><div class="column">
<p>MCAR</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = perfMCAR_meanImpute ~ IQ, data = jobPerf)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5234 -1.2723 -0.4509  1.3402  4.0215 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  2.94177    3.81241   0.772   0.4503  
IQ           0.07658    0.03777   2.028   0.0577 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.326 on 18 degrees of freedom
Multiple R-squared:  0.1859,    Adjusted R-squared:  0.1407 
F-statistic: 4.112 on 1 and 18 DF,  p-value: 0.05766</code></pre>
</div>
</div>
</div></div>
</section>
<section id="unconditional-mean-imputation-mar-data-vs-complete-data" class="slide level2">
<h2>Unconditional Mean Imputation: MAR Data vs Complete Data</h2>
<div class="columns">
<div class="column">
<p>Complete</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ perfC, data = jobPerf)

Residuals:
    Min      1Q  Median      3Q     Max 
-23.569  -7.425   1.216   6.572  29.287 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   70.439     11.143   6.322 5.87e-06 ***
perfC          2.856      1.044   2.736   0.0136 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.2 on 18 degrees of freedom
Multiple R-squared:  0.2937,    Adjusted R-squared:  0.2545 
F-statistic: 7.487 on 1 and 18 DF,  p-value: 0.01357</code></pre>
</div>
</div>
</div><div class="column">
<p>MAR</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IQ ~ perfMAR_meanImpute, data = jobPerf)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.000  -8.418   2.272   7.288  30.435 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          71.480     13.506   5.293 4.95e-05 ***
perfMAR_meanImpute    2.674      1.237   2.162   0.0443 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.93 on 18 degrees of freedom
Multiple R-squared:  0.2061,    Adjusted R-squared:  0.162 
F-statistic: 4.674 on 1 and 18 DF,  p-value: 0.04434</code></pre>
</div>
</div>
</div></div>
</section></section>
<section id="conditional-mean-imputation-regression" class="title-slide slide level1 center">
<h1>Conditional Mean Imputation (Regression)</h1>
<ul>
<li>Conditional mean imputation uses regression analyses to impute missing values
<ul>
<li>The missing values are imputed using the predicted values in each regression (conditional means)</li>
</ul></li>
<li>For our data we would form regressions for each outcome using the other variables
<ul>
<li>PERF = β01 + β11*IQ</li>
</ul></li>
<li>More accurate than unconditional mean imputation
<ul>
<li>But still provides biased parameters and SEs</li>
</ul></li>
</ul>
</section>

<section id="stochastic-conditional-mean-imputation" class="title-slide slide level1 center">
<h1>Stochastic Conditional Mean Imputation</h1>
<ul>
<li>Stochastic conditional mean imputation adds a random component to the imputation
<ul>
<li>Representing the error term in each regression equation</li>
<li>Assumes MAR rather than MCAR</li>
</ul></li>
<li>Better than any other of these methods (and the basis for multiple imputation)</li>
</ul>
</section>

<section id="imputation-by-proximity-hot-deck-matching" class="title-slide slide level1 center">
<h1>Imputation by Proximity: Hot Deck Matching</h1>
<ul>
<li>Hot deck matching uses real data – from other observations as its basis for imputing</li>
<li>Observations are “matched” using similar scores on variables in the data set
<ul>
<li>Imputed values come directly from matched observations</li>
</ul></li>
<li>Upside: Helps to preserve univariate distributions; gives data in an appropriate range</li>
<li>Downside: biased estimates (especially of regression coefficients), too-small standard errors</li>
</ul>
</section>

<section id="scale-imputation-by-averaging" class="title-slide slide level1 center">
<h1>Scale Imputation by Averaging</h1>
<ul>
<li>In psychometric tests, a common method of imputation has been to use a scale average rather than total score
<ul>
<li>Can re-scale to total score by taking # items * average score</li>
</ul></li>
<li>Problem: treating missing items this way is like using person mean
<ul>
<li>Reduces standard errors</li>
<li>Makes calculation of reliability biased</li>
</ul></li>
</ul>
</section>

<section id="longitudinal-imputation-last-observation-carried-forward" class="title-slide slide level1 center">
<h1>Longitudinal Imputation: Last Observation Carried Forward</h1>
<ul>
<li>A commonly used imputation method in longitudinal data has been to treat observations that dropped out by carrying forward thelast observation
<ul>
<li>More common in medical studies and clinical trials</li>
</ul></li>
<li>Assumes scores do not change after dropout – bad idea
<ul>
<li>Thought to be conservative</li>
</ul></li>
<li>Can exaggerate group differences
<ul>
<li>Limits standard errors that help detect group differences</li>
</ul></li>
</ul>
</section>

<section id="why-single-imputation-is-bad-science" class="title-slide slide level1 center">
<h1>Why Single Imputation Is Bad Science</h1>
<ul>
<li>Overall, the methods described in this section are not useful for handling missing data</li>
<li>If you use them you will likely get a statistical answer that is an artifact
<ul>
<li>Actual estimates you interpret (parameter estimates) will be biased (in either direction)</li>
<li>Standard errors will be too small
<ul>
<li>Leads to Type-I Errors</li>
</ul></li>
</ul></li>
<li>Putting this together: you will likely end up making conclusions about your data that are wrong</li>
</ul>
</section>

<section>
<section id="auxiliary-variables-and-semi-partial-correlation" class="title-slide slide level1 center">
<h1>Auxiliary Variables and Semi-Partial Correlation</h1>

</section>
<section id="auxiliary-variables-and-semi-partial-correlation-1" class="slide level2">
<h2>Auxiliary Variables and Semi-Partial Correlation</h2>
<p>The use of <strong>auxiliary variables</strong> can help mitigate bias and improve statistical power when missing data are present</p>
<ul>
<li>An auxiliary variable is an extraneous variable that correlates with missingness or the outcome but is not part of the main analysis</li>
</ul>
<p>A key aspect of auxiliary variable selection is understanding their <strong>semi-partial correlation</strong> with the outcome</p>
<ul>
<li>Semi-partial correlation quantifies the unique contribution of a predictor to the outcome, after removing its shared variance with other predictors</li>
<li>This makes Semi-partial correlations useful for identifying the most informative auxiliary variables</li>
</ul>
</section></section>
<section id="what-is-a-semi-partial-correlation" class="title-slide slide level1 center">
<h1>What is a Semi-Partial Correlation?</h1>
<ul>
<li><strong>Semi-partial correlation</strong> (also known as part correlation) measures the unique association between a predictor and the outcome while controlling for other variables in the model</li>
<li>Unlike <strong>partial correlation</strong>, which removes shared variance from both variables, semi-partial correlation removes shared variance only from the predictor variable, leaving the outcome variable unchanged</li>
</ul>
</section>

<section>
<section id="what-is-a-semi-partial-correlation-1" class="title-slide slide level1 center">
<h1>What is a Semi-Partial Correlation?</h1>
<p>Mathematically, the semi-partial correlation of a predictor <span class="math inline">\(( X_1 )\)</span> with an outcome <span class="math inline">\((Y)\)</span>, controlling for another predictor <span class="math inline">\(X_2\)</span>, is given by:</p>
<p><span class="math display">\[ r_{Y(X_1.X_2)} = \frac{r_{YX_1} - r_{YX_2}r_{X_1X_2}}{\sqrt{1 - r_{X_1X_2}^2}} \]</span></p>
<p>where: - <span class="math inline">\(r_{YX_1}\)</span>is the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1\)</span>, - <span class="math inline">\(r_{YX_2}\)</span> is the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_2\)</span>, - <span class="math inline">\(r_{X_1X_2}\)</span> is the correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</p>
</section>
<section id="why-is-semi-partial-correlation-important" class="slide level2">
<h2>Why is Semi-Partial Correlation Important?</h2>
<p>Semi-partial correlation is widely used in statistics for several reasons:</p>
<ol type="1">
<li><strong>Understanding Unique Contributions</strong> – It helps to determine how much unique variance a predictor explains in the outcome, which is useful in multiple regression and hierarchical modeling</li>
<li><strong>Feature Selection</strong> – In machine learning and predictive modeling, semi-partial correlation can help identify the most important predictors</li>
<li><strong>Model Interpretation</strong> – Researchers can use it to assess the relative importance of predictors in explaining variance in an outcome</li>
<li><strong>Comparing Predictors</strong> – It allows us to compare multiple predictors to see which has the most unique explanatory power</li>
</ol>
<p>Because semi-partial correlation removes shared variance only from the predictor, it reflects the real-world scenario where some predictors contribute uniquely to an outcome while sharing variance with others.</p>
</section>
<section id="semi-partial-correlation-in-the-context-of-missing-data" class="slide level2">
<h2>Semi-Partial Correlation in the Context of Missing Data</h2>
<ul>
<li>Semi-partial correlations help identify which auxiliary variables provide unique information about missingness or the outcome
<ul>
<li>This ensures that missing data handling methods, such as multiple imputation or maximum likelihood estimation, make the most use of available information</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="example-in-r" class="title-slide slide level1 center">
<h1>Example in R</h1>

</section>
<section id="simulated-data" class="slide level2">
<h2>Simulated Data</h2>
<p>Let’s create a dataset where we examine semi-partial correlations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-2"><a href=""></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb18-3"><a href=""></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">50</span>, <span class="at">sd=</span><span class="dv">10</span>)   <span class="co"># Outcome variable</span></span>
<span id="cb18-4"><a href=""></a>x1 <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">5</span>)    <span class="co"># Predictor 1</span></span>
<span id="cb18-5"><a href=""></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">20</span>, <span class="at">sd=</span><span class="dv">5</span>)    <span class="co"># Predictor 2</span></span>
<span id="cb18-6"><a href=""></a>aux <span class="ot">=</span> .<span class="dv">05</span><span class="sc">*</span>y <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">2</span>)  <span class="co"># Auxiliary variable</span></span>
<span id="cb18-7"><a href=""></a></span>
<span id="cb18-8"><a href=""></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(y, x1, x2, aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-semi-partial-correlation-using-lm-residuals" class="slide level2">
<h2>Computing Semi-Partial Correlation using lm() residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="co"># Step 1: Regress the auxiliary variable on other predictors and obtain residuals</span></span>
<span id="cb19-2"><a href=""></a>aux_resid <span class="ot">=</span> <span class="fu">resid</span>(<span class="fu">lm</span>(aux <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>data))</span>
<span id="cb19-3"><a href=""></a></span>
<span id="cb19-4"><a href=""></a><span class="co"># Step 2: Compute the correlation between residuals and the outcome</span></span>
<span id="cb19-5"><a href=""></a>spr_lm <span class="ot">=</span> <span class="fu">cor</span>(aux_resid, data<span class="sc">$</span>y)</span>
<span id="cb19-6"><a href=""></a><span class="fu">print</span>(spr_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3371851</code></pre>
</div>
</div>
</section>
<section id="computing-semi-partial-correlation-using-the-ppcor-package" class="slide level2">
<h2>Computing Semi-Partial Correlation using the <code>ppcor</code> package</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># Compute semi-partial correlation using spcorr package</span></span>
<span id="cb21-2"><a href=""></a>spr_spcorr <span class="ot">=</span> <span class="fu">spcor</span>(data)</span>
<span id="cb21-3"><a href=""></a><span class="fu">print</span>(spr_spcorr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$estimate
             y         x1         x2       aux
y    1.0000000 -0.2359666 -0.3182904 0.3371851
x1  -0.1543577  1.0000000 -0.3222919 0.7896905
x2  -0.2605867 -0.4033669  1.0000000 0.6280408
aux  0.1904317  0.6817890  0.4332414 1.0000000

$p.value
              y           x1           x2          aux
y   0.000000000 1.932959e-02 1.403247e-03 6.859535e-04
x1  0.129123301 0.000000e+00 1.210448e-03 4.366625e-22
x2  0.009555429 3.816958e-05 0.000000e+00 4.454870e-12
aux 0.060351647 1.092502e-14 8.354724e-06 0.000000e+00

$statistic
            y        x1        x2       aux
y    0.000000 -2.379176 -3.289682  3.509232
x1  -1.530736  0.000000 -3.335800 12.611715
x2  -2.644587 -4.319133  0.000000  7.907571
aux  1.900622  9.131503  4.709848  0.000000

$n
[1] 100

$gp
[1] 2

$method
[1] "pearson"</code></pre>
</div>
</div>
</section></section>
<section id="comparison-of-results" class="title-slide slide level1 center">
<h1>Comparison of Results</h1>
<p>Both methods should yield similar results, but <code>spcor</code> provides a more automated way to compute semi-partial correlations, making it easier to handle multiple predictors at once.</p>
<ul>
<li>But, ‘spcor’ doesn’t have the ability to specify certain combinations of variables</li>
</ul>
<p>Interpretation:</p>
<ul>
<li>If the semi-partial correlation is strong (e.g., above 0.30 in absolute value), the auxiliary variable is likely to contain unique information about the outcome and should be included in the missing data handling process</li>
</ul>
</section>

<section id="wrapping-up" class="title-slide slide level1 center">
<h1>Wrapping Up</h1>

</section>

<section id="lecture-summary" class="title-slide slide level1 center">
<h1>Lecture Summary</h1>
<ul>
<li>Missing data are common in statistical analyses</li>
<li>They are frequently neglected
<ul>
<li>MNAR: hard to model missing data and observed data simultaneously</li>
<li>MCAR: doesn’t often happen</li>
<li>MAR: most missing imputation assumes MVN</li>
</ul></li>
<li>More often than not, ML is the best choice
<ul>
<li>Software is getting better at handling missing data</li>
<li>We will discuss how ML works next week</li>
</ul></li>
</ul>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://jonathantemplin.github.io/MissingDataMethods2025/">https://jonathantemplin.github.io/MissingDataMethods2025/</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="01_Introduction_Missing_Data_S2025_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>